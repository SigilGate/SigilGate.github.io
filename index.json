[{"content":" Root-нода — центральный узел управления сетью. Не участвует в передаче пользовательского трафика. Выполняет функции Root CA, начального развертывания и администрирования всех нод. Роль в архитектуре #Root-нода находится вне плоскости данных — через нее не проходит пользовательский трафик. Она работает исключительно в плоскости управления: PKI, развертывание, конфигурирование, мониторинг.\ngraph TD Root[\"Root-нодауправление, PKI\"] Core1[\"Core-нода #1вне региона\"] Core2[\"Core-нода #2вне региона\"] Entry1[\"Entry-нода Aвнутри региона\"] Entry2[\"Entry-нода Bвнутри региона\"] Entry3[\"Entry-нода Cвнутри региона\"] Root --\u003e|SSH| Core1 Root --\u003e|SSH| Core2 Root --\u003e|SSH| Entry1 Root --\u003e|SSH| Entry2 Root --\u003e|SSH| Entry3 style Root fill:#7c3aed,color:#fff,stroke:#6d28d9 style Core1 fill:#1d4ed8,color:#fff,stroke:#1e40af style Core2 fill:#1d4ed8,color:#fff,stroke:#1e40af style Entry1 fill:#0891b2,color:#fff,stroke:#0e7490 style Entry2 fill:#0891b2,color:#fff,stroke:#0e7490 style Entry3 fill:#0891b2,color:#fff,stroke:#0e7490 Характеристики # Параметр Значение Функция Управление сетью, Root CA, развертывание Участие в трафике Нет (только плоскость управления) Расположение Любой сегмент сети Жизненный цикл Долгоживущая, критическая Протокол управления SSH Функции #1. Root CA (центр сертификации) #Root-нода хранит корневой приватный ключ PKI-иерархии и выпускает сертификаты для Core-нод.\ngraph TD RootCA[\"Root CARoot-нода\"] IntCA1[\"Промежуточный CACore-нода #1\"] IntCA2[\"Промежуточный CACore-нода #2\"] Cert1[\"Сертификат Entry A\"] Cert2[\"Сертификат Entry B\"] Cert3[\"Сертификат Entry C\"] RootCA --\u003e|\"выпускает\"| IntCA1 RootCA --\u003e|\"выпускает\"| IntCA2 IntCA1 --\u003e|\"выпускает\"| Cert1 IntCA1 --\u003e|\"выпускает\"| Cert2 IntCA2 --\u003e|\"выпускает\"| Cert3 style RootCA fill:#7c3aed,color:#fff,stroke:#6d28d9 style IntCA1 fill:#1d4ed8,color:#fff,stroke:#1e40af style IntCA2 fill:#1d4ed8,color:#fff,stroke:#1e40af style Cert1 fill:#0891b2,color:#fff,stroke:#0e7490 style Cert2 fill:#0891b2,color:#fff,stroke:#0e7490 style Cert3 fill:#0891b2,color:#fff,stroke:#0e7490 Root CA выпускает сертификаты только для Core-нод. Core-ноды (промежуточные CA) выпускают сертификаты для Entry-нод. Root-нода не выпускает сертификаты для Entry-нод напрямую. 2. Развертывание сети #С Root-ноды выполняется начальное развертывание всех нод:\nподготовка серверов (системные пакеты, firewall, SSH-ключи); установка и настройка Nginx, Xray-core; развертывание сайтов-прикрытий; выпуск и распространение сертификатов. 3. Администрирование #Root-нода — единственная точка, с которой осуществляется полное администрирование сети:\nобновление конфигураций на всех нодах; ротация путей gRPC, сертификатов, ключей; диагностика и мониторинг; добавление и вывод нод из оборота. Однонаправленный доступ #Root-нода имеет SSH-доступ ко всем нодам сети. Обратное запрещено: ни Core-ноды, ни Entry-ноды не имеют доступа к Root-ноде.\nНаправление Разрешен Root → Core-нода Root → Entry-нода Core-нода → Root Entry-нода → Root Компоненты #В отличие от Core- и Entry-нод, Root-нода не содержит Nginx, Xray или сайт-прикрытие. На ней установлены только инструменты управления:\nКомпонент Назначение SSH-клиент Доступ к нодам OpenSSL / CA-инструменты Управление PKI Git Работа с репозиторием Скрипты деплоя Автоматизация развертывания Совмещение с Core-нодой # Роль Root-ноды может быть совмещена с Core-нодой, но это нежелательно. Совмещение увеличивает поверхность атаки: Core-нода участвует в передаче данных и доступна из интернета, что создает дополнительные риски для приватного ключа Root CA и SSH-ключей ко всем нодам сети. При совмещении Root и Core на одном сервере:\nкомпрометация Core-ноды автоматически означает компрометацию Root — критический инцидент для всей сети; сервер становится доступен из интернета по портам 80 и 443, что увеличивает поверхность атаки; единая точка отказа: выход из строя сервера одновременно лишает сеть и узла ядра, и центра управления. В продуктивной среде Root-нода должна быть выделенным сервером без публичных сервисов.\nБезопасность #Root-нода — самый критичный узел сети:\nхранит приватный ключ Root CA; имеет SSH-доступ ко всем нодам; содержит полный реестр инфраструктуры. Рекомендации # Минимум сервисов (нет Nginx, нет Xray, нет публичных портов). SSH-доступ только по ключу. Регулярное обновление системы. Резервное копирование приватного ключа Root CA в безопасное хранилище. Реагирование на компрометацию # Компрометация Root-ноды — критический инцидент, означающий потенциальную компрометацию всей сети. Порядок действий:\nНемедленно: отозвать все SSH-ключи на всех нодах. Немедленно: перегенерировать Root CA. Перевыпустить все сертификаты Core-нод. Перевыпустить все сертификаты Entry-нод (через Core-ноды). Развернуть новую Root-ноду. ","date":"1 января 1 г.","permalink":"https://sigilgate.github.io/docs/nodes/root/","section":"Документация","summary":"Центральный узел управления — Root CA, развертывание и администрирование всех нод сети","title":"Root-нода"},{"content":" Sigil Gate — приватная сеть с архитектурой «ядро-периферия», устойчивая к обнаружению системами DPI и активному зондированию. Архитектура #Сеть Sigil Gate построена по модели «ядро-периферия» — плотно связанное ядро из Core-нод и периферия из Entry-нод, подключенных к ядру.\nПринципы # Устойчивость к DPI — трафик на каждом участке сети неотличим от легитимной HTTPS-активности. Децентрализация — отсутствие единой точки отказа в плоскости данных; выход одного узла не нарушает работу остальных. Масштабируемость — сеть растет добавлением новых Entry- и Core-нод без перестройки существующей инфраструктуры. Адаптивная топология — сеть гибко реагирует на изменения: вывод узлов, перераспределение нагрузки, смена маршрутов. Простота эксплуатации — типовые операции (развертывание, ротация, мониторинг) автоматизированы и выполняются скриптами с управляющего узла. Федерация — сеть способна принимать новые узлы и объединяться с другими сетями, построенными на той же архитектуре. Сущности #Система состоит из четырех типов сущностей:\nТип Роль Плоскость Расположение Жизненный цикл Root-нода Центр управления, PKI, развертывание Управление Любой сегмент Долгоживущая, критическая Core-нода Ядро сети, маршрутизация трафика в интернет Данные + управление Вне региона Долгоживущая Entry-нода Входной узел, прием клиентских подключений Данные Внутри региона Расходная, ротируемая Клиент Устройство пользователя Данные Внутри региона — graph TD Root[\"Root-нодауправление, PKI\"] Core[\"Core-нодаядро, маршрутизация\"] Entry[\"Entry-нодапериферия, прием подключений\"] Client[\"Клиентустройство пользователя\"] Root --\u003e|\"SSH\"| Core Root --\u003e|\"SSH\"| Entry Client --\u003e|\"VLESS + gRPC\"| Entry Entry --\u003e|\"VLESS + gRPC\"| Core style Root fill:#7c3aed,color:#fff,stroke:#6d28d9 style Core fill:#1d4ed8,color:#fff,stroke:#1e40af style Entry fill:#0891b2,color:#fff,stroke:#0e7490 style Client fill:#64748b,color:#fff,stroke:#475569 Плоскость данных #Пользовательский трафик проходит через цепочку: Клиент → Entry-нода → Core-нода → Интернет. Root-нода не участвует в передаче данных.\ngraph TD Client[\"Клиентвнутри региона\"] Entry[\"Entry-нодавнутри региона\"] Core[\"Core-нодавне региона\"] Internet[\"Интернет\"] Client --\u003e|\"VLESS + gRPCTLS 1.3\"| Entry Entry --\u003e|\"VLESS + gRPCTLS 1.3\"| Core Core --\u003e Internet style Client fill:#64748b,color:#fff,stroke:#475569 style Entry fill:#0891b2,color:#fff,stroke:#0e7490 style Core fill:#1d4ed8,color:#fff,stroke:#1e40af style Internet fill:#374151,color:#fff,stroke:#1f2937 Топология «ядро-периферия» #Ядро сети образовано Core-нодами, которые связаны между собой (mesh). Периферия — Entry-ноды — подключается к ядру, но не связана между собой.\nДля передачи данных Entry-нода может быть связана с несколькими Core-нодами, но не более чем с третью от общего числа Core-нод. Это ограничение реализует принцип минимальной связности: при компрометации Entry-ноды раскрывается лишь малая часть ядра сети.\nМаскировка трафика #На каждом участке сети трафик неотличим от легитимной HTTPS-активности:\nУчасток Что видит наблюдатель Реальность Клиент → Entry HTTPS-запросы к обычному сайту VPN-туннель (VLESS + gRPC) Entry → Core gRPC-вызовы к API микросервисов VPN-туннель (VLESS + gRPC) На обоих участках:\nTLS 1.3 handshake — стандартный, неотличимый от обычного; валидный сертификат Let\u0026rsquo;s Encrypt; при обращении без VLESS-заголовков сервер отдает сайт-прикрытие (HTTP 200 OK). Защита от активного зондирования #На каждом узле сети в плоскости данных сервер Xray расположен за веб-сервером. При обращении на любой URL без правильных VLESS-заголовков веб-сервер возвращает сайт-прикрытие. Наблюдатель не может отличить «секретный путь» от «обычной страницы» — нет характерных ошибок, редиректов или отказов.\nПротокольный стек # graph TB subgraph \"Протокольный стек\" TLS[\"TLS 1.3Let's Encrypt\"] gRPC[\"gRPC (HTTP/2)\"] VLESS[\"VLESS\"] end TLS --- gRPC gRPC --- VLESS style TLS fill:#7c3aed,color:#fff,stroke:#6d28d9 style gRPC fill:#2563eb,color:#fff,stroke:#1d4ed8 style VLESS fill:#1d4ed8,color:#fff,stroke:#1e40af Уровень Технология Назначение Шифрование TLS 1.3 Шифрование канала, валидный сертификат Транспорт gRPC (HTTP/2) Мультиплексирование, маскировка под API Протокол VLESS Легковесный прокси-протокол Рассмотрев альтернативы, gRPC выбран как единственный транспорт:\nустойчив к обнаружению (в отличие от XHTTP); высокая производительность (в отличие от WebSocket); трафик идентичен легитимным gRPC API микросервисов. Динамическая ротация путей #Core-ноды периодически генерируют новые случайные gRPC-пути на участке Entry → Core. Это затрудняет статистический анализ трафика. Клиентские пути при этом не затрагиваются.\nАдминистрирование #Плоскость управления #Root-нода администрирует всю сеть по SSH. Доступ — однонаправленный: Root имеет доступ ко всем нодам, обратный доступ запрещен.\ngraph TD Root[\"Root-нодауправление, PKI\"] Core1[\"Core-нода #1\"] Core2[\"Core-нода #2\"] Entry1[\"Entry-нода A\"] Entry2[\"Entry-нода B\"] Entry3[\"Entry-нода C\"] Root --\u003e|SSH| Core1 Root --\u003e|SSH| Core2 Root --\u003e|SSH| Entry1 Root --\u003e|SSH| Entry2 Root --\u003e|SSH| Entry3 Core1 ---|\"mesh\"| Core2 style Root fill:#7c3aed,color:#fff,stroke:#6d28d9 style Core1 fill:#1d4ed8,color:#fff,stroke:#1e40af style Core2 fill:#1d4ed8,color:#fff,stroke:#1e40af style Entry1 fill:#0891b2,color:#fff,stroke:#0e7490 style Entry2 fill:#0891b2,color:#fff,stroke:#0e7490 style Entry3 fill:#0891b2,color:#fff,stroke:#0e7490 Административная привязка #Каждая Entry-нода в каждый момент времени административно закреплена за одной Core-нодой. Core-нода отвечает за конфигурирование, ротацию путей и мониторинг своих Entry-нод.\nЭто образует древовидную структуру в плоскости управления:\ngraph TD Core1[\"Core-нода #1\"] Core2[\"Core-нода #2\"] E1[\"Entry A\"] E2[\"Entry B\"] E3[\"Entry C\"] E4[\"Entry D\"] E5[\"Entry E\"] Core1 --\u003e E1 Core1 --\u003e E2 Core1 --\u003e E3 Core2 --\u003e E4 Core2 --\u003e E5 Core1 ---|\"mesh\"| Core2 style Core1 fill:#1d4ed8,color:#fff,stroke:#1e40af style Core2 fill:#1d4ed8,color:#fff,stroke:#1e40af style E1 fill:#0891b2,color:#fff,stroke:#0e7490 style E2 fill:#0891b2,color:#fff,stroke:#0e7490 style E3 fill:#0891b2,color:#fff,stroke:#0e7490 style E4 fill:#0891b2,color:#fff,stroke:#0e7490 style E5 fill:#0891b2,color:#fff,stroke:#0e7490 Core-ноды могут передавать свои Entry-ноды друг другу — например, для вывода Core-ноды из ротации на обслуживание. Это обеспечивает эксплуатационную гибкость без потери связности.\nУправление с Core-нод #Помимо Root-ноды, типовые операции по управлению сетью могут выполняться с любой Core-ноды: добавление новых Entry-нод, регистрация пользователей, ротация путей. Это позволяет администрировать сеть без постоянного доступа к Root-ноде.\nИнфраструктура открытых ключей (PKI) #Сеть использует трехуровневую иерархию сертификатов:\ngraph TD RootCA[\"Root CARoot-нода\"] IntCA1[\"Промежуточный CACore-нода #1\"] IntCA2[\"Промежуточный CACore-нода #2\"] Cert1[\"СертификатEntry-нода A\"] Cert2[\"СертификатEntry-нода B\"] Cert3[\"СертификатEntry-нода C\"] RootCA --\u003e IntCA1 RootCA --\u003e IntCA2 IntCA1 --\u003e Cert1 IntCA1 --\u003e Cert2 IntCA2 --\u003e Cert3 style RootCA fill:#7c3aed,color:#fff,stroke:#6d28d9 style IntCA1 fill:#1d4ed8,color:#fff,stroke:#1e40af style IntCA2 fill:#1d4ed8,color:#fff,stroke:#1e40af style Cert1 fill:#0891b2,color:#fff,stroke:#0e7490 style Cert2 fill:#0891b2,color:#fff,stroke:#0e7490 style Cert3 fill:#0891b2,color:#fff,stroke:#0e7490 Сертификат Где хранится Срок жизни Отзыв Root CA Root-нода Долгосрочный Ручной, критический инцидент Промежуточный CA Core-нода Долгосрочный Ручной, с Root-ноды Сертификат Entry Entry-нода Часы / дни Автоматический Компрометация и реагирование # Под компрометацией ноды понимается не только несанкционированный доступ к ноде, но и обнаружение и блокировка системами DPI. Признаки компрометации — потеря HTTPS-связности между Entry- и Core-нодами при сохранении SSH-доступа, или существенная деградация канала связи. Компрометация Entry-ноды # Вывести скомпрометированную Entry-ноду из оборота. Если общее количество Core-нод \u0026gt; 2 — вывести Core-ноды, известные этой Entry-ноде. Перевыпустить сертификаты для затронутых компонентов. Компрометация Root-ноды (критический инцидент) # Немедленно отозвать все SSH-ключи на всех нодах. Перегенерировать Root CA. Перевыпустить все сертификаты Core-нод и Entry-нод. Развернуть новую Root-ноду. Глоссарий # Термин Определение Core-periphery Сетевая топология с плотно связанным ядром и слабо связанной периферией Root-нода Центр управления сетью и Root CA; не участвует в трафике Core-нода Узел ядра сети; маршрутизирует трафик в интернет, промежуточный CA Entry-нода Входной узел периферии; принимает клиентские подключения VLESS Легковесный прокси-протокол семейства V2Ray gRPC Высокопроизводительный RPC-фреймворк на базе HTTP/2 DPI Deep Packet Inspection — глубокий анализ сетевых пакетов Active probing Техника DPI: активное подключение к серверу для проверки протокола Fallback Резервный ответ (сайт-прикрытие) при отсутствии VLESS-заголовков PKI Public Key Infrastructure — инфраструктура открытых ключей Soft affinity Условная привязка Entry-ноды к Core-ноде, допускающая переназначение ","date":null,"permalink":"https://sigilgate.github.io/docs/","section":"Документация","summary":"Обзор архитектуры, типы нод, принципы маскировки и устойчивости к DPI","title":"Документация"},{"content":" Core-нода — узел ядра сети, который принимает трафик от Entry-нод и маршрутизирует его в открытый интернет. Размещается вне регулируемого региона. Выполняет роль промежуточного CA в PKI-иерархии. Роль в архитектуре # graph TD Client[\"Клиент\"] Entry[\"Entry-нода\"] Core[\"Core-нода\"] Internet[\"Интернет\"] Client --\u003e|\"VLESS + gRPCTLS 1.3\"| Entry Entry --\u003e|\"VLESS + gRPCTLS 1.3\"| Core Core --\u003e Internet style Core fill:#1d4ed8,color:#fff,stroke:#1e40af,stroke-width:3px style Client fill:#64748b,color:#fff,stroke:#475569 style Entry fill:#0891b2,color:#fff,stroke:#0e7490 style Internet fill:#374151,color:#fff,stroke:#1f2937 Core-нода — последнее звено в цепочке перед выходом в открытый интернет. Она принимает зашифрованный трафик от Entry-нод и направляет его к целевым ресурсам.\nХарактеристики # Параметр Значение Функция Маршрутизация трафика в интернет, промежуточный CA Расположение Вне регулируемого региона Жизненный цикл Долгоживущая Компоненты Nginx + Xray-core + сайт-прикрытие Открытые порты 22 (SSH), 80 (HTTP → HTTPS), 443 (HTTPS) Маскировка gRPC API микросервисов Компоненты # graph TD subgraph core[\"Core-нода\"] Nginx[\"Nginx0.0.0.0:443\"] Xray[\"Xray-core127.0.0.1:10003\"] Site[\"Сайт-прикрытие\"] Nginx --\u003e|\"/api.v2.rpc.{path}\"| Xray Nginx --\u003e|\"/\"| Site end Entry[\"Entry-нода\"] --\u003e|\"TLS 1.3\"| Nginx Xray --\u003e Internet[\"Интернет\"] style Nginx fill:#7c3aed,color:#fff,stroke:#6d28d9 style Xray fill:#2563eb,color:#fff,stroke:#1d4ed8 style Site fill:#64748b,color:#fff,stroke:#475569 style Entry fill:#0891b2,color:#fff,stroke:#0e7490 style Internet fill:#374151,color:#fff,stroke:#1f2937 Nginx # TLS-терминация с сертификатом Let\u0026rsquo;s Encrypt; маршрутизация по URL path: gRPC-трафик направляется на Xray, все остальные запросы — на сайт-прикрытие; fallback: любой неизвестный запрос возвращает сайт-прикрытие (HTTP 200 OK). Xray-core # Слушает только на 127.0.0.1 (недоступен извне); протокол: VLESS + gRPC; inbound: принимает трафик от Entry-нод; outbound: freedom — прямой выход в интернет. Сайт-прикрытие # Полноценный веб-сайт (SPA), доступный по основному домену; при обращении к любому URL без VLESS-заголовков — возвращается сайт-прикрытие; контент уникальный и нейтральный, сайт выглядит «живым» при ручной проверке. Ядро сети (mesh) #Core-ноды образуют ядро сетевой топологии core-periphery. Между собой они связаны полносвязной mesh-сетью:\nCore-ноды проверяют друг друга через общий Root CA; при необходимости Core-ноды могут передавать друг другу административную ответственность за Entry-ноды; выход одной Core-ноды из строя не нарушает работу остальных. graph TD Core1[\"Core #1\"] Core2[\"Core #2\"] Core3[\"Core #3\"] Core1 ---|\"Root CA\"| Core2 Core2 ---|\"Root CA\"| Core3 Core1 ---|\"Root CA\"| Core3 style Core1 fill:#1d4ed8,color:#fff,stroke:#1e40af style Core2 fill:#1d4ed8,color:#fff,stroke:#1e40af style Core3 fill:#1d4ed8,color:#fff,stroke:#1e40af Управление Entry-нодами #Каждая Core-нода административно отвечает за группу Entry-нод:\nконфигурирование Xray и Nginx на Entry-нодах; ротация gRPC-путей на участке Entry → Core; мониторинг состояния и доступности; выпуск сертификатов для Entry-нод (промежуточный CA). Core-нода имеет SSH-доступ к своим Entry-нодам по ключу для автоматизации этих операций.\nCore-ноды могут передавать свои Entry-ноды другим Core-нодам — например, для вывода Core-ноды из ротации на обслуживание. Механизмы передачи находятся на этапе архитектурного планирования. Ротация gRPC-путей #Core-нода периодически генерирует новые случайные gRPC-пути (/api/v2/rpc/{random}/) и обновляет конфигурацию на всех своих Entry-нодах. Процесс:\nГенерация нового случайного пути. Обновление конфигурации Nginx и Xray на Core-ноде. Валидация новой конфигурации. Обновление конфигурации на каждой Entry-ноде по SSH. В случае ошибки — автоматический откат. Клиентские пути при этом не затрагиваются — ротация касается только участка Entry → Core.\nПромежуточный CA (PKI) #Core-нода выступает промежуточным удостоверяющим центром:\nполучает свой сертификат от Root CA (Root-нода); выпускает сертификаты для Entry-нод; Entry-ноды принимают сертификаты любой Core-ноды сети. Параметр Значение Источник сертификата Root CA (Root-нода) Срок жизни Долгосрочный Выпускает сертификаты для Entry-нод Отзыв Ручной, с Root-ноды Маскировка трафика #На участке Entry → Core трафик выглядит как gRPC-вызовы к API микросервисов:\nстандартный TLS 1.3 handshake; валидный сертификат Let\u0026rsquo;s Encrypt; HTTP/2 с gRPC content-type; случайные serviceName, имитирующие реальные API. Этот участок наиболее уязвим для анализа DPI, так как трафик пересекает границу регулируемого региона.\nТребования к серверу # Параметр Минимум CPU 1 vCPU RAM 512 MB Диск 10 GB SSD ОС Ubuntu 22.04 / Debian 12 IPv4 Выделенный белый адрес Локация Вне регулируемого региона Реагирование на компрометацию #При компрометации Core-ноды (обнаружение и блокировка DPI):\nУведомить администратора (Root-нода). Перевести Entry-ноды, привязанные к этой Core-ноде, на другие Core-ноды. Отозвать сертификат промежуточного CA скомпрометированной Core-ноды. Перевыпустить сертификаты Entry-нод, которые были привязаны к этой Core-ноде. При необходимости — развернуть новую Core-ноду. ","date":"1 января 1 г.","permalink":"https://sigilgate.github.io/docs/nodes/core/","section":"Документация","summary":"Ядро сети — маршрутизация трафика в интернет, TLS-терминация, промежуточный CA","title":"Core-нода"},{"content":" Каждый узел плоскости данных (Core-нода и Entry-нода) проходит стандартную процедуру начальной настройки безопасности перед вводом в эксплуатацию. Цель — минимизировать поверхность атаки и обеспечить безопасное удаленное управление. Базовые настройка безопасности #Требования к серверу # Параметр Минимум ОС Debian 12 / Ubuntu 22.04 RAM 512 MB Диск 10 GB SSD Сеть Выделенный IPv4, открытый порт 22 Права доступа Пользователь root или пользователь с правами sudo Этапы настройки #Настройка выполняется последовательно с Root-ноды (или другого управляющего сервера) и состоит из семи этапов:\ngraph TD S1[\"1. Проверка и диагностика\"] S2[\"2. Обновление системы\"] S3[\"3. Создание сервисного пользователя\"] S4[\"4. Размещение SSH-ключа\"] S5[\"5. Проверка доступа по ключу\"] S6[\"6. Защита SSH\"] S7[\"7. Настройка firewall\"] S1 --\u003e S2 --\u003e S3 --\u003e S4 --\u003e S5 --\u003e S6 --\u003e S7 style S1 fill:#1e40af,color:#fff,stroke:#1d4ed8 style S2 fill:#1e40af,color:#fff,stroke:#1d4ed8 style S3 fill:#1e40af,color:#fff,stroke:#1d4ed8 style S4 fill:#1e40af,color:#fff,stroke:#1d4ed8 style S5 fill:#1e40af,color:#fff,stroke:#1d4ed8 style S6 fill:#7c3aed,color:#fff,stroke:#1d4ed8 style S7 fill:#7c3aed,color:#fff,stroke:#1d4ed8 1. Проверка и диагностика #Проверка сетевой доступности сервера и SSH-авторизации root по паролю. На этом этапе проводится диагностика: версия ОС, объем RAM, дисковое пространство. Параметры сервера регистрируются в системе хранения данных сети Sigil Gate.\n2. Обновление системы # Полное обновление пакетов (apt update \u0026amp;\u0026amp; apt upgrade). Установка базовых зависимостей: sudo, curl, wget, ufw, cron. Настройка автоматического обновления безопасности (ежедневно). 3. Создание сервисного пользователя #Создание непривилегированного пользователя с правами sudo. Вся дальнейшая работа с нодой выполняется от имени этого пользователя, а не от root.\n4. Размещение SSH-ключа #Публичный SSH-ключ управляющего сервера размещается в ~/.ssh/authorized_keys сервисного пользователя. Права на директорию и файл устанавливаются в соответствии со стандартами OpenSSH (700/600).\n5. Проверка доступа по ключу #Верификация: сервисный пользователь может подключиться по SSH-ключу без пароля и выполнять команды через sudo.\n6. Защита SSH #Применение ключевых настроек sshd_config:\nПараметр Значение Назначение PermitRootLogin no Запрет входа root PasswordAuthentication no Запрет авторизации по паролю PubkeyAuthentication yes Авторизация только по ключу После применения доступ к серверу возможен только по SSH-ключу для сервисного пользователя.\n7. Настройка firewall #Настройка UFW (Uncomplicated Firewall):\nПравило Описание По умолчанию Запрет всех входящих соединений Порт 22 SSH — удаленное управление Порт 80 HTTP — перенаправление на HTTPS Порт 443 HTTPS — основной рабочий порт Модель SSH-доступа #Для разграничения привилегий используются отдельные SSH-ключи для разных уровней доступа:\ngraph TD RootKey[\"Ключ Root-ноды\"] CoreKey[\"Ключ Core-ноды\"] Core[\"Core-ноды\"] Entry[\"Entry-ноды\"] RootKey --\u003e|\"полный доступ\"| Core RootKey --\u003e|\"полный доступ\"| Entry CoreKey --\u003e|\"управление\"| Entry style RootKey fill:#7c3aed,color:#fff,stroke:#6d28d9 style CoreKey fill:#1d4ed8,color:#fff,stroke:#1e40af style Core fill:#1d4ed8,color:#fff,stroke:#1e40af style Entry fill:#0891b2,color:#fff,stroke:#0e7490 Ключ Доступ Назначение Ключ Root-ноды Все ноды (Core + Entry) Полное администрирование сети Ключ Core-ноды Entry-ноды Управление привязанными Entry-нодами Результат настройки #После прохождения всех этапов нода готова к установке специфичных компонентов (Nginx, Xray-core, сайт-прикрытие):\nсистема обновлена, установлены базовые пакеты; настроено автоматическое обновление безопасности; создан сервисный пользователь с правами sudo; SSH-доступ — только по ключу, вход root отключен; firewall разрешает только порты 22, 80, 443. ","date":null,"permalink":"https://sigilgate.github.io/docs/nodes/","section":"Документация","summary":"Общие требования к серверам и базовые настройки безопасности узлов сети","title":"Узлы сети"},{"content":" Entry-нода — входной узел сети, который принимает клиентские подключения и перенаправляет трафик на Core-ноды. Размещается внутри регулируемого региона. Расходная, легко заменяемая — предполагается постоянная ротация. Роль в архитектуре # graph TD Client[\"Клиент\"] Entry[\"Entry-нода\"] Core[\"Core-нода\"] Internet[\"Интернет\"] Client --\u003e|\"VLESS + gRPCTLS 1.3\"| Entry Entry --\u003e|\"VLESS + gRPCTLS 1.3\"| Core Core --\u003e Internet style Entry fill:#0891b2,color:#fff,stroke:#0e7490,stroke-width:3px style Client fill:#64748b,color:#fff,stroke:#475569 style Core fill:#1d4ed8,color:#fff,stroke:#1e40af style Internet fill:#374151,color:#fff,stroke:#1f2937 Entry-нода — первая точка контакта пользователя с сетью Sigil Gate. Клиент подключается к Entry-ноде как к обычному HTTPS-сайту; Entry-нода извлекает VPN-трафик и перенаправляет его на Core-ноду.\nХарактеристики # Параметр Значение Функция Прием клиентских подключений, перенаправление на Core Расположение Внутри регулируемого региона Жизненный цикл Недолгоживущая, расходная Компоненты Nginx + Xray-core + сайт-прикрытие Открытые порты 22 (SSH), 80 (HTTP → HTTPS), 443 (HTTPS) Маскировка Обычный HTTPS-сайт Компоненты # graph TD subgraph entry[\"Entry-нода\"] Nginx[\"Nginx0.0.0.0:443\"] Xray[\"Xray-core127.0.0.1:10003\"] Site[\"Сайт-прикрытие\"] Nginx --\u003e|\"/api.v2.rpc.{path}\"| Xray Nginx --\u003e|\"/\"| Site end Client[\"Клиент\"] --\u003e|\"TLS 1.3\"| Nginx Xray --\u003e|\"VLESS + gRPCTLS 1.3\"| Core[\"Core-нода\"] style Nginx fill:#7c3aed,color:#fff,stroke:#6d28d9 style Xray fill:#2563eb,color:#fff,stroke:#1d4ed8 style Site fill:#64748b,color:#fff,stroke:#475569 style Client fill:#64748b,color:#fff,stroke:#475569 style Core fill:#1d4ed8,color:#fff,stroke:#1e40af Nginx # TLS-терминация с сертификатом Let\u0026rsquo;s Encrypt; маршрутизация по URL path: gRPC-трафик от клиентов направляется на Xray, все остальные запросы — на сайт-прикрытие; fallback: любой запрос без VLESS-заголовков возвращает сайт-прикрытие (HTTP 200 OK). Xray-core # Слушает только на 127.0.0.1 (недоступен извне); протокол: VLESS + gRPC; inbound: принимает трафик от клиентов; outbound: перенаправляет трафик на Core-ноду через VLESS + gRPC + TLS 1.3. Сайт-прикрытие # Полноценный веб-сайт (SPA), доступный по основному домену; контент уникальный, нейтральный; при ручной проверке сайт выглядит «живым» и легитимным. Расположение и логика #Entry-ноды размещаются внутри регулируемого региона (например, в российских ЦОД). Это принципиальное архитектурное решение:\nтрафик от клиента к Entry-ноде не покидает регион; для систем DPI это выглядит как обычные HTTPS-запросы к локальному сайту; трафик к локальным ресурсам не попадает в приоритетный список для глубокого анализа. Периферия сети #Entry-ноды образуют периферию в топологии core-periphery:\nне связаны между собой; не знают о существовании других Entry-нод; подключены к ядру (Core-нодам), но не ко всему — каждая Entry-нода знает не более трети от общего числа Core-нод. graph TD Core1[\"Core #1\"] Core2[\"Core #2\"] Core3[\"Core #3\"] E1[\"Entry A\"] E2[\"Entry B\"] E3[\"Entry C\"] E4[\"Entry D\"] E1 -.-\u003e|\"данные\"| Core1 E2 -.-\u003e|\"данные\"| Core1 E2 -.-\u003e|\"данные\"| Core2 E3 -.-\u003e|\"данные\"| Core2 E4 -.-\u003e|\"данные\"| Core3 Core1 ---|\"mesh\"| Core2 Core2 ---|\"mesh\"| Core3 Core1 ---|\"mesh\"| Core3 style Core1 fill:#1d4ed8,color:#fff,stroke:#1e40af style Core2 fill:#1d4ed8,color:#fff,stroke:#1e40af style Core3 fill:#1d4ed8,color:#fff,stroke:#1e40af style E1 fill:#0891b2,color:#fff,stroke:#0e7490 style E2 fill:#0891b2,color:#fff,stroke:#0e7490 style E3 fill:#0891b2,color:#fff,stroke:#0e7490 style E4 fill:#0891b2,color:#fff,stroke:#0e7490 Принцип минимальной связности #Ограничение знания топологии — ключевой принцип безопасности. Если Entry-нода скомпрометирована (обнаружена DPI), раскрывается только малая часть ядра сети. Остальные Core-ноды остаются неизвестными для наблюдателя.\nЖизненный цикл #Entry-ноды расходные — они спроектированы для частой замены:\ngraph LR Deploy[\"Развертывание\"] Active[\"Эксплуатация\"] Detect[\"Компрометация\"] Decom[\"Вывод\"] New[\"Новая Entry\"] Deploy --\u003e Active Active --\u003e Detect Detect --\u003e Decom Decom --\u003e New New --\u003e Deploy style Deploy fill:#2563eb,color:#fff,stroke:#1d4ed8 style Active fill:#0891b2,color:#fff,stroke:#0e7490 style Detect fill:#7c3aed,color:#fff,stroke:#6d28d9 style Decom fill:#64748b,color:#fff,stroke:#475569 style New fill:#2563eb,color:#fff,stroke:#1d4ed8 Развертывание — быстрая настройка по стандартному процессу; Эксплуатация — прием клиентских подключений; Компрометация — обнаружение и блокировка DPI (потеря HTTPS-связности с Core при сохранении SSH); Вывод — отключение, отзыв сертификата; Замена — развертывание новой Entry-ноды с новым доменом и IP. Планируется множество однотипных Entry-нод с постоянной ротацией.\nАдминистративная привязка #Каждая Entry-нода в каждый момент времени административно закреплена за одной Core-нодой. Core-нода отвечает за:\nконфигурирование Entry-ноды; ротацию gRPC-путей; мониторинг состояния; выпуск сертификатов (промежуточный CA). Привязка — условная (soft affinity). Core-ноды могут передавать Entry-ноды друг другу.\nМаскировка трафика #Участок Клиент → Entry # Что видит наблюдатель Реальность HTTPS-запросы к обычному сайту VPN-туннель (VLESS + gRPC) Стандартный TLS 1.3 handshake Стандартный TLS 1.3 handshake Валидный сертификат Let\u0026rsquo;s Encrypt Валидный сертификат Let\u0026rsquo;s Encrypt Контент сайта при прямом обращении Сайт-прикрытие (fallback) Защита от активного зондирования # При обращении к любому URL без VLESS-заголовков — сайт-прикрытие (HTTP 200 OK); нет характерных ошибок, редиректов или отказов; gRPC-пути случайные и ротируемые — не /ws/, не /vless/. Безопасность # Xray слушает только 127.0.0.1; пути gRPC — случайные; firewall: только порты 22, 80, 443; SSH-доступ по ключу (доступ от Root-ноды и закрепленной Core-ноды). Требования к серверу # Параметр Минимум CPU 1 vCPU RAM 512 MB Диск 10 GB SSD ОС Ubuntu 22.04 / Debian 12 IPv4 Выделенный белый адрес Локация Внутри регулируемого региона Реагирование на компрометацию # Признаки компрометации Entry-ноды: потеря HTTPS-связности с Core-нодами при сохранении SSH-доступа, или существенная деградация канала связи. Порядок действий:\nВывести скомпрометированную Entry-ноду из оборота. Если общее количество Core-нод \u0026gt; 2 — вывести Core-ноды, известные этой Entry-ноде. Отозвать сертификат Entry-ноды. Перевыпустить сертификаты для затронутых компонентов. Развернуть новую Entry-ноду с новым доменом и IP-адресом. ","date":"1 января 1 г.","permalink":"https://sigilgate.github.io/docs/nodes/entry/","section":"Документация","summary":"Входной узел периферии — прием клиентских подключений, маскировка под HTTPS-сайт","title":"Entry-нода"},{"content":" Клиент — конечная точка подключения пользователя к сети Sigil Gate. Работает на устройстве пользователя и устанавливает защищенное соединение с Entry-нодой. Роль в архитектуре # graph TD Client[\"Клиент\"] Entry[\"Entry-нода\"] Core[\"Core-нода\"] Internet[\"Интернет\"] Client --\u003e|\"VLESS + gRPCTLS 1.3\"| Entry Entry --\u003e|\"VLESS + gRPCTLS 1.3\"| Core Core --\u003e Internet style Client fill:#64748b,color:#fff,stroke:#475569,stroke-width:3px style Entry fill:#0891b2,color:#fff,stroke:#0e7490 style Core fill:#1d4ed8,color:#fff,stroke:#1e40af style Internet fill:#374151,color:#fff,stroke:#1f2937 Клиент подключается к Entry-ноде как к обычному HTTPS-сайту. Для внешнего наблюдателя соединение неотличимо от обычного веб-трафика.\nПоддерживаемые платформы # Платформа Клиент Статус Android v2rayNG Протестировано, работает Android NekoBox Не работает iOS — Протестировано, работает Windows — В планах macOS — В планах Linux — В планах Параметры подключения #Для подключения необходимы следующие параметры (получить у администратора):\nПараметр Описание UUID Идентификатор пользователя Домен Адрес Entry-ноды Порт 443 Транспорт gRPC serviceName Имя gRPC-сервиса (путь) Параметры TLS # Параметр Значение Security tls SNI пустое (автоматически = домен) Fingerprint chrome ALPN h2 Получение конфигурации #На текущем этапе управление пользователями — ручное. Конфигурацию для подключения можно получить у администратора.\nФорматы:\nVLESS-ссылка — импортируется в клиент одним действием; QR-код — сканируется мобильным приложением. Формат VLESS-ссылки #vless://{UUID}@{DOMAIN}:443?type=grpc\u0026amp;security=tls\u0026amp;serviceName={SERVICE_NAME}\u0026amp;fp=chrome\u0026amp;alpn=h2#{NAME} Плейсхолдер Описание {UUID} Идентификатор пользователя {DOMAIN} Домен Entry-ноды {SERVICE_NAME} Имя gRPC-сервиса {NAME} Отображаемое имя профиля Настройка клиентов #v2rayNG (Android) # Получите VLESS-ссылку у администратора. Скопируйте ссылку. В v2rayNG: + → Import config from clipboard. Выберите профиль → нажмите V для подключения. iOS #Клиент уточняется. Принцип настройки аналогичен — импорт VLESS-ссылки.\nПроверка работоспособности #Откройте в браузере сайт, недоступный без VPN. Если сайт открывается — подключение работает.\nНе используйте встроенные тесты клиентов — они проверяют доступность Google-сервисов (gstatic.com и др.), которые могут быть заблокированы в вашей сети. Тест покажет ошибку даже при рабочем VPN. Известные проблемы #NekoBox не подключается #NekoBox (Android) имеет проблемы с подключением даже в последней версии. Используйте v2rayNG.\nВстроенные тесты показывают ошибки #Это нормально. Тесты проверяют Google-сервисы, которые заблокированы. Проверяйте работоспособность реальными сайтами.\nЧастые разрывы соединения (Android) #Отключите оптимизацию батареи для клиента: Настройки → Приложения → v2rayNG → Батарея → Без ограничений.\n","date":"1 января 1 г.","permalink":"https://sigilgate.github.io/docs/nodes/client/","section":"Документация","summary":"Клиентская часть — подключение пользователя к сети через Entry-ноду","title":"Клиент"},{"content":" Узнать больше... ","date":null,"permalink":"https://sigilgate.github.io/","section":"Sigil Gate","summary":"\u003cdiv style=\"text-align: center;\"\u003e\n\u003ca\n  class=\"inline-block !rounded-md bg-primary-600 px-4 py-1 !text-neutral !no-underline hover:!bg-primary-500 dark:bg-primary-800 dark:hover:!bg-primary-700\"\n  href=\"/about/\"\n  \n  \n  role=\"button\"\n\u003e\n  Узнать больше...\n\u003c/a\u003e\n\n\u003c/div\u003e","title":"Sigil Gate"},{"content":" Строим сеть, которую сложно обнаружить, и рассказываем об этом в блоге, который легко найти. ","date":null,"permalink":"https://sigilgate.github.io/blog/","section":"Блог проекта Sigil Gate","summary":"\u003cp\u003e \u003c/p\u003e\n\u003cdiv class=\"lead !mb-9 text-xl\"\u003e\n  Строим сеть, которую сложно обнаружить, и рассказываем об этом в блоге, который легко найти.\n\u003c/div\u003e","title":"Блог проекта Sigil Gate"},{"content":"","date":null,"permalink":"https://sigilgate.github.io/tags/","section":"Tags","summary":"","title":"Tags"},{"content":"Забавно, как отрабатывает система таргетированного маркетинга в Google.\nВчера на работе мы включили трек певицы Аннет «На работе», и я решил заглянуть в поисковик — посмотреть об исполнителе: кто, откуда, какого года выпуска и так далее.\nИ тут же, вечером, Google, адаптировавшись видимо к моим интересам, выдал мне ссылку на Анет. Но на совсем другую Анет — ANet, VPN-проект на Rust с собственным транспортным протоколом.\nЧестно говоря, я немного подофигел.\nЯ почувствовал себя героем советского анекдота — про эмигранта, приехавшего на историческую родину, которого Израиль встречает табличкой в аэропорту:\nПомни! Не ты один здесь еврей!\nВот уж действительно — оказывается, я такой не один.\nПроект, так же как и Sigil Gate, концентрируется на построении частных сетей для небольшой группы: друзей, родственников или знакомых. На входе в репозиторий вас приветствует аватар аниме-кошкодевочки и приветствие:\nANet: Сеть Друзей\nANet — это инструмент для организации приватного, защищенного информационного пространства между близкими людьми. Мы строим цифровые мосты там, где обычные пути недоступны.\nЭто не сервис. Это технология для связи тех, кто доверяет друг другу.\nВ общем, ребятам тоже есть о чем рассказать: о связях, о соединениях и о том, как все непросто. Пишут в основном на Rust и копают довольно глубоко: свой клиент, свой сервер и даже свой транспортный протокол ASTP, по смыслу похожий, кажется, на QUIC.\nИз критики #На мой взгляд, основная проблема сейчас — не в том, чтобы зашифровать трафик, и даже не в том, чтобы завернуть его в протокол, который со стороны выглядит как белый шум. Именно это и делают ребята из ANet — отправляют по UDP зашифрованные и обфусцированные пакеты случайными порциями.\nКритически важная проблема сейчас — маскировка под обычный TLS-трафик.\nЛюбой, самый сложный и непонятный для наблюдателя протокол, отличающийся от обычного потока — неизбежно будет вычислен и либо урезан по скорости до черепашьего, либо заблокирован на корню. Какое-то время подобное решение может продержаться — лишь за счет небольшой распространенности или специфичности, на которую не обращают внимания в силу незначительности трафика. Но рано или поздно придут и за такими решениями. Так что брать это на вооружение я бы, пожалуй, не стал.\nНо посмотреть все равно интересно.\n","date":"6 февраля 2026 г.","permalink":"https://sigilgate.github.io/blog/%D0%BA%D0%BE%D0%B3%D0%B4%D0%B0-%D1%82%D0%B0%D1%80%D0%B3%D0%B5%D1%82%D0%B8%D0%BD%D0%B3-%D0%BF%D0%BE%D0%BF%D0%B0%D0%B4%D0%B0%D0%B5%D1%82-%D0%B2-%D1%86%D0%B5%D0%BB%D1%8C/","section":"Блог проекта Sigil Gate","summary":"Искал певицу Аннет — нашел проект ANet. Забавно, как работает таргетированная реклама, когда ты строишь приватную сеть.","title":"Когда таргетинг попадает в цель"},{"content":"","date":null,"permalink":"https://sigilgate.github.io/tags/%D0%BC%D0%B0%D1%81%D0%BA%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B0/","section":"Tags","summary":"","title":"Маскировка"},{"content":"","date":null,"permalink":"https://sigilgate.github.io/tags/%D1%80%D0%B0%D0%B7%D0%BC%D1%8B%D1%88%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F/","section":"Tags","summary":"","title":"Размышления"},{"content":"","date":null,"permalink":"https://sigilgate.github.io/tags/new/","section":"Tags","summary":"","title":"New"},{"content":"","date":null,"permalink":"https://sigilgate.github.io/tags/telegram/","section":"Tags","summary":"","title":"Telegram"},{"content":"Я прислушиваюсь к критике и стараюсь воспринимать все конструктивно.\nСогласен, что читать посты по ссылке в канале, наверное, не очень удобно. Наверное, стоит оставить этот формат для анонсов, ну и просто для того, чтобы периодически напоминать об основном блоге и перенаправлять на сайт.\nВсе-таки телеграм-канал — это отдельная история. Я решил отбранчевать телеграм-ветку и складывать в ней контент в этом, специфическом, формате.\nБольшие посты будут ужиматься, подача будет больше рассчитана на диалог или обсуждение, больше эмоджиков, ну и особенности форматирования тоже придется учесть (телеграм использует свое подмножество Markdown, или можно вставлять HTML).\nПопробую сделать это и посмотрю, что получится.\n","date":"6 февраля 2026 г.","permalink":"https://sigilgate.github.io/blog/%D1%80%D0%B0%D0%B7%D0%B2%D0%B8%D0%B2%D0%B0%D0%B5%D0%BC-%D1%82%D0%B5%D0%BB%D0%B5%D0%B3%D1%80%D0%B0%D0%BC-%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB/","section":"Блог проекта Sigil Gate","summary":"Телеграм-канал — это отдельная история. Отбранчевываем ветку под контент для канала и настраиваем автоматическую публикацию.","title":"Развиваем телеграм-канал"},{"content":"","date":null,"permalink":"https://sigilgate.github.io/tags/%D0%B4%D0%BE%D0%BA%D1%83%D0%BC%D0%B5%D0%BD%D1%82%D0%B0%D1%86%D0%B8%D1%8F/","section":"Tags","summary":"","title":"Документация"},{"content":"","date":null,"permalink":"https://sigilgate.github.io/tags/%D0%BE%D0%BF%D0%B5%D0%BD%D1%81%D0%BE%D1%80%D1%81/","section":"Tags","summary":"","title":"Опенсорс"},{"content":"Cеть работает. Технические решения найдены. Мы прошли через эксперименты с протоколами, настройку узлов, поиск рабочих комбинаций — и в результате получили инфраструктуру, которая делает то, что должна: обходит блокировки, проходит через систему DPI и обеспечивает связь.\nЭто уже победа. Но за время работы над прототипом у меня образовалась проблема. Я сваливал все в одну кучу: учетные данные, скрипты, документацию, исследования, заметки. Все в одном месте — удобно для быстрого старта, но смерть для развития и масштабирования проекта. Невнятная структура, размытые границы, груды устаревающей информации.\nСтало очевидно: пора распилить этот монолит на части.\nСоздание организации #Я создал отдельную организацию на GitHub, чтобы разнести все по специализированным репозиториям. Данные — отдельно. Скрипты управления — отдельно. Гайды — отдельно от учетных данных. Часть информации останется приватной, часть станет публичной.\nСейчас я сосредоточен на переносе документации. Раздел \u0026ldquo;Документация\u0026rdquo; на сайте начал постепенно наполняться. Потихоньку перетаскиваю из приватного репозитория: описание типов узлов, топология, базовые принципы. Это только начало — кое-где надо навести красоты, многое еще выглядит достаточно сыро и нуждается в переработке, но процесс запущен.\nРаздел \u0026ldquo;Документация\u0026rdquo; #Для опенсорс-проекта документация — это фундамент. Хорошая документация — это прозрачность архитектуры. Это навигация по репозиториям организации. Это возможность для любого посетителя понять с первого взгляда, куда он попал и как здесь все устроено.\nЭто важно для потенциальных контрибьютеров, для будущих фолловеров, и вообще для всех, кто выразил интерес и просто зашел взглянуть. Документация — это точка входа и первое впечатление.\nЕсть еще один аспект, менее очевидный, но не менее важный.\nЯ уже писал об этом в контексте страницы «О проекте»: когда плотно работаешь с AI, критически важно иметь возможность быстро и точно сформировать контекст. Подробная, хорошо структурированная документация, отражающая актуальное состояние проекта, позволяет свести эту работу к минимуму: «Изучи информацию на сайте. Прочитай документацию проекта.»\nСейчас, в эпоху AI, документация приобретает новую роль — она становится интерфейсом для AI-ассистентов. И чем точнее документация отражает состояние проекта, тем эффективнее становится работа по формированию контекста.\nТак что — разбираем завалы, раскладывем все по полочкам. Распиливаем монолит на части.\nСегодня документация. Затем учетные данные и система хранения информации. Затем - автоматизация и скрипты, а после этого можно уже начинать масштабироваться. Работы впереди еще много.\n","date":"4 февраля 2026 г.","permalink":"https://sigilgate.github.io/blog/%D1%80%D0%B0%D0%B7%D0%B4%D0%B5%D0%BB-%D0%B4%D0%BE%D0%BA%D1%83%D0%BC%D0%B5%D0%BD%D1%82%D0%B0%D1%86%D0%B8%D1%8F/","section":"Блог проекта Sigil Gate","summary":"Проект работает. Сеть функционирует. Теперь — время навести порядок в документации и сделать проект по-настоящему открытым.","title":"Раздел «Документация»"},{"content":"Сегодня я полностью переработал раздел «О проекте».\nДо сегодняшнего дня это была страничка в три предложения: Sigil Gate, принципы и пара ссылок. Заглушка — минимум информации, чтобы страница не пустовала. Достаточно для запуска сайта, но проект растет, и его становится тяжело описать в двух словах.\nТеперь раздел полностью переработан. Вместо короткого описания — развернутый рассказ о проекте, разбитый на несколько смысловых блоков:\nО проекте — что такое Sigil Gate и почему проект частично открытый. Цели и задачи — децентрализованная архитектура, устойчивая к обнаружению, и практические планы. Миссия — свободный доступ к информации и открытое комьюнити. Статус проекта — где мы сейчас и откуда выросли. Команда — кто стоит за проектом. Участие в проекте — как присоединиться. Зачем все это #Мотивация очень простая. Проект выходит в публичную плоскость: веб-страница, блог, телеграм-канал. Это опенсорс, детка!\nСтраница «О проекте» — это первое, что видит человек, который хочет понять, куда он попал. Она должна отвечать на базовые вопросы: что это, зачем, кто за этим стоит и как можно в этом поучаствовать.\nИ речь идет не только о людях. Есть другая, неочевидная, сторона.\nКогда плотно работаешь с AI, очень важно коротко, емко и структурировано рассказать про проект, обозначить текущее состояние и перспективы развития. Задать рамки и правила. Дать правильный контекст, расставить акценты.\nТогда работа по формированию контекста может быть сведена к двум предложениям: «Изучи информацию на сайте. Прочитай документацию проекта.»\nЧто дальше #И кстати, о документации. В планах — перенос архитектурной документации из приватного репозитория в публичный раздел Docs на сайте. Общие принципы, описание топологии, работа протоколов — все это должно быть открыто, доступно, четко структурировано и сложено в одном месте. Но это уже следующий этап.\n","date":"2 февраля 2026 г.","permalink":"https://sigilgate.github.io/blog/%D1%80%D0%B0%D0%B7%D0%B4%D0%B5%D0%BB-%D0%BE-%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B5/","section":"Блог проекта Sigil Gate","summary":"Старая страница About была заглушкой. Теперь это полноценный раздел с целями, миссией, командой и приглашением к участию.","title":"Раздел «О проекте»"},{"content":"","date":null,"permalink":"https://sigilgate.github.io/tags/%D1%81%D0%B0%D0%B9%D1%82/","section":"Tags","summary":"","title":"Сайт"},{"content":"","date":null,"permalink":"https://sigilgate.github.io/tags/linux/","section":"Tags","summary":"","title":"Linux"},{"content":"","date":null,"permalink":"https://sigilgate.github.io/tags/systemd/","section":"Tags","summary":"","title":"Systemd"},{"content":"Я ощущаю себя пещерным человеком.\nМне уже много лет, и есть вещи, к которым я привык настолько, что воспринимаю их как константу. Они всегда на своих местах. Они всегда работают. Я никогда не задумываюсь, есть ли что-то еще — потому что зачем, если и так все хорошо?\nКогда мне нужно запускать что-то регулярно, с заданной периодичностью — я использую cron. Я не знаю, сколько лет этой утилите. Мне кажется, она была всегда. Открыл crontab -e, написал расписание, забыл. Работает.\nНо сегодня, решая очередную задачу с периодическим запуском, я с удивлением узнал, что альтернатива существует. Причем довольно давно.\nSystemd timer — это механизм планирования задач, встроенный в systemd. Он решает те же задачи, что и cron, но с бо́льшей точностью и бо́льшим количеством опций:\nГранулярность до секунд. У cron минимальный интервал — одна минута. У systemd timer такого ограничения нет. Защита от дублирования. Если предыдущий запуск еще не завершился — новый не запустится. Cron этого не контролирует: если скрипт работает дольше интервала, запустится второй экземпляр поверх первого. Логирование через journalctl. Все запуски, выводы, ошибки — в одном месте. Не нужно вручную перенаправлять stdout в файл. RandomizedDelaySec. Случайное смещение времени запуска. Задача стартует не ровно по расписанию, а в случайный момент внутри заданного окна. Это усложняет выявление паттерна по времени — полезно, когда предсказуемость запуска нежелательна. Зависимости. Можно указать, что задача должна запускаться только после поднятия сети, после запуска другого сервиса, после монтирования диска. Cron просто стреляет по расписанию, не глядя на состояние системы (или надо лопатить свои костыли). Persistent. Если система была выключена в момент запланированного пуска — задача выполнится сразу после загрузки. Cron же пропущенные запуски просто теряет. Совсем недавно мне нужно было настроить автоматическую ротацию случайно генерируемых gRPC-путей между нодами. Для этого можно было бы использовать cron. Но\u0026hellip;наверное, пора выходить из пещеры.\nТеперь, когда я знаю про systemd timer, в планах:\nНастроить мониторинг через journalctl — алерты при ошибках ротации, агрегация логов. Тонко настроить случайный сдвиг — чтобы еще сильнее затруднить статистический анализ времени ротации системами обнаружения. Зависимость от сети — не пытаться ротировать, если сеть еще не поднялась после перезагрузки. И, возможно, еще что-то, что умеет systemd timer и не умеет cron. Подозреваю, я пока узнал далеко не все. ","date":"1 февраля 2026 г.","permalink":"https://sigilgate.github.io/blog/systemd-timer-%D0%B2%D1%80%D0%B5%D0%BC%D1%8F-%D0%B2%D1%8B%D1%85%D0%BE%D0%B4%D0%B8%D1%82%D1%8C-%D0%B8%D0%B7-%D0%BF%D0%B5%D1%89%D0%B5%D1%80%D1%8B/","section":"Блог проекта Sigil Gate","summary":"Всю жизнь использовал cron. Оказывается, уже давно есть кое-что получше.","title":"Systemd timer: время выходить из пещеры"},{"content":"","date":null,"permalink":"https://sigilgate.github.io/tags/%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F/","section":"Tags","summary":"","title":"Автоматизация"},{"content":"","date":null,"permalink":"https://sigilgate.github.io/tags/grpc/","section":"Tags","summary":"","title":"Grpc"},{"content":"","date":null,"permalink":"https://sigilgate.github.io/tags/xray/","section":"Tags","summary":"","title":"Xray"},{"content":"","date":null,"permalink":"https://sigilgate.github.io/tags/%D0%B1%D0%B5%D0%B7%D0%BE%D0%BF%D0%B0%D1%81%D0%BD%D0%BE%D1%81%D1%82%D1%8C/","section":"Tags","summary":"","title":"Безопасность"},{"content":"Давно было в планах — и вот, наконец, свершилось.\nВ нашей архитектуре самый критический участок — это соединение между entry-нодой и core-нодой. Это трансграничный канал: именно он пересекает периметр, на который направлено повышенное внимание систем DPI.\nVLESS поверх gRPC — сильная комбинация. Трафик практически неотличим от обычного HTTPS: TLS с валидным сертификатом, HTTP/2, браузерный TLS-фингерпринт. Со стороны это выглядит как обращение к обычному веб-сервису. Распознать его по сигнатурам практически невозможно.\nНо «практически неотличим» не означает «невозможно вычислить».\nДаже если содержимое трафика зашифровано и протокол замаскирован, остаются метаданные: кто, куда, как часто, как долго. Постоянное соединение по одному и тому же gRPC-пути на одном хосте — это паттерн. Даже для легитимного gRPC-микросервиса это выглядит подозрительно: реальные сервисы обычно обращаются по разным эндпоинтам.\nЕсли путь не меняется неделями — это маркер. Статистический анализ может выделить такое соединение из общего потока.\nРешение: менять gRPC serviceName автоматически, с заданной периодичностью. Каждый новый путь — случайно сгенерированная строка. Со стороны это выглядит как активность различных сервисов и пользователей одного хоста.\nЯ долго откладывал реализацию, но сегодня руки наконец дошли.\nВ минимальной реализации это bash-скрипт на core-ноде, который запускается по systemd timer. Скрипт генерирует новый случайный путь, обновляет конфигурации Nginx и Xray на core-ноде, а затем по SSH пушит изменение outbound-пути на каждую entry-ноду.\nВажный момент: клиентская сторона не затрагивается. Путь ротируется только на внутреннем участке entry→core. Клиентам не нужно ничего перенастраивать — они продолжают подключаться к entry-ноде по прежнему адресу.\nТекущие ограничения #На короткие секунды в момент ротации связь может пропадать — сервисы перезагружаются. Клиент переподключается автоматически, но разрыв заметен.\nВ перспективе мы перейдем на Xray gRPC API (hot reload). Это позволит менять пути без перезагрузки сервисов — ротация станет бесшовной, без разрыва соединения.\nСейчас ротация настроена на каждый час. Практика покажет, приносит ли это ощутимые неудобства на клиенте. Если нет — будем увеличивать интервал или перенесем время ротации на периоды наименьшей активности.\n","date":"1 февраля 2026 г.","permalink":"https://sigilgate.github.io/blog/%D1%80%D0%BE%D1%82%D0%B0%D1%86%D0%B8%D1%8F-grpc-%D0%BF%D1%83%D1%82%D0%B5%D0%B9/","section":"Блог проекта Sigil Gate","summary":"Давно было в планах — и вот свершилось. Самый уязвимый участок сети теперь защищен автоматической ротацией адресов.","title":"Ротация gRPC-путей"},{"content":"","date":null,"permalink":"https://sigilgate.github.io/tags/hugo/","section":"Tags","summary":"","title":"Hugo"},{"content":"После перехода на Congo первое, что бросается в глаза — все просто работает. Темный режим, переключение языков, навигация — ничего не сломалось, все выглядит аккуратно и стильно.\nОдна маленькая деталь #Есть вещь, которая меня давно удивляет: почему в подавляющем большинстве тем текст выравнивается по левому краю? Почему? Ну, почему?! О, Боги! — мой внутренний перфекционист страдает, когда видит четкий край слева — и рваную нестройную елочку из строчек справа. Что мешает четко обозначить правила и границы блоков? Это выглядит очень неряшливо — особенно на широких экранах, где строки длинные и неровность бросается в глаза.\nВыравнивание по ширине (justify) делает текст визуально собранным — как в книге или хорошо сверстанном журнале. Да, у justify есть свои нюансы с переносами, но\u0026hellip; выравнивание по ширине — это, несомненно, мой выбор.\nКак исправить #Congo предусматривает файл assets/css/custom.css для пользовательских стилей — он подключается автоматически и не затрагивается при обновлении темы. Достаточно одного правила:\n.prose { text-align: justify; } Готово. Теперь текст выровнен по ширине, и при следующем обновлении Congo ничего не сломается.\n","date":"1 февраля 2026 г.","permalink":"https://sigilgate.github.io/blog/%D0%BF%D0%B5%D1%80%D0%B2%D1%8B%D0%B5-%D0%B2%D0%BF%D0%B5%D1%87%D0%B0%D1%82%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F-%D0%BE%D1%82-%D0%BD%D0%BE%D0%B2%D0%BE%D0%B9-%D1%82%D0%B5%D0%BC%D1%8B/","section":"Блог проекта Sigil Gate","summary":"Тема Congo работает отлично, но\u0026hellip;","title":"Первые впечатления от новой темы"},{"content":"","date":null,"permalink":"https://sigilgate.github.io/tags/%D1%82%D0%B5%D0%BC%D0%B0/","section":"Tags","summary":"","title":"Тема"},{"content":"У меня практически не было сомнений, какой фреймворк использовать для сборки сайта. Ну, конечно же: hugo — минималистичный и быстрый. У меня накопился некоторый опыт его использования на других проектах. Если понадобится залезть в его кишки и что-нибудь там поправить — это не будет большой проблемой.\nОднако, выбор темы оформления — совсем другое. Дизайн, вкусовщина, и творческие муки — выбор всегда тяжел. В итоге, пересмотрев немало вариантов, я остановил свой выбор на Congo. Вот несколько причин.\nПочему Congo? #Свежий взгляд. Иногда просто хочется чего-то нового. Прежняя тема меня устраивала: она была строгой и подходила для документации. Но здесь мне захотелось большего простора для творчества. Все-таки, наполовину это задумывается как личный блог, хотя и с профессиональным уклоном.\nМультиязычность. Congo поддерживает i18n из коробки — отдельные конфиги для каждого языка. Я стараюсь внедрять мультиязычность во всех своих проектах — это помогает мне сохранять и поддерживать уровень английского. К тому же — кто знает, на какой регион и на какую аудиторию этот проект может выйти в будущем?\nТемная тема из коробки. Темное оформление Congo уходит в глубокие фиолетовые тона — и это совпадает с настроением, которое я сейчас переживаю.\nИдея маскота #У меня есть идея сделать маскота для этого проекта — кошкодевочку-волшебницу. Фиолетовые волосы, темно-фиолетовы одежды и капюшон друида, из-под которого светятся розовые глаза. Волшебный посох в руках, с фирменой символикой Sigil Gate (есть несколько мыслей как использовать его в качестве логотипа). Пока это только концепт, но он хорошо ложится в общую атмосферу. Я размышлял над визуальной идентичностью проекта: темно-фиолетовые и голубые тона на белом фоне, с яркими вкраплениями красно-розового и сине-голубого (надо будет оформить брендбук).\nПримеры сайтов на Congo #Если хотите посмотреть, как тема выглядит на реальных сайтах:\nCongo demo — официальное демо темы leif.io — личный сайт и техноблог antoinesoetewey.com — personal site major.io — личный сайт и блог softwarewitchcraft.com — личный блог gorbe.io — бизнес-сайт и блог Полный список сайтов на Congo можно найти на странице пользователей темы.\n","date":"1 февраля 2026 г.","permalink":"https://sigilgate.github.io/blog/%D0%B2%D1%8B%D0%B1%D0%BE%D1%80-%D1%82%D0%B5%D0%BC%D1%8B-%D0%BE%D1%84%D0%BE%D1%80%D0%BC%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F-%D0%B4%D0%BB%D1%8F-%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B0-sigil-gate/","section":"Блог проекта Sigil Gate","summary":"Congo в качестве темы оформления — выбираю, устанавливаю и рассказываю, почему.","title":"Выбор темы оформления для проекта Sigil Gate"},{"content":"","date":null,"permalink":"https://sigilgate.github.io/categories/","section":"Categories","summary":"","title":"Categories"},{"content":"Архитектура хранения данных для сети Sigil Gate #Этот документ описывает архитектуру, выбранную для организации распределенного и надежного хранения данных сети Sigil Gate. Он охватывает проблему, постановку задачи, рассмотренные альтернативы, итоговое решение, его компоненты, механизмы синхронизации и дорожную карту развития.\nОглавление # Введение: Проблема, Цели и Ограничения Рассмотренные Альтернативные Решения Итоговая Архитектура: Гибридный Подход Компоненты Системы Кластер Key-Value Хранилища Репозиторий Git как Источник Истины Взаимодействие Узлов с Хранилищами Синхронизация Данных и Обеспечение Консистентности Дорожная Карта Развития ","date":null,"permalink":"https://sigilgate.github.io/docs/data_storage/","section":"Документация","summary":"\u003ch1 id=\"архитектура-хранения-данных-для-сети-sigil-gate\" class=\"relative group\"\u003eАрхитектура хранения данных для сети Sigil Gate \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#%d0%b0%d1%80%d1%85%d0%b8%d1%82%d0%b5%d0%ba%d1%82%d1%83%d1%80%d0%b0-%d1%85%d1%80%d0%b0%d0%bd%d0%b5%d0%bd%d0%b8%d1%8f-%d0%b4%d0%b0%d0%bd%d0%bd%d1%8b%d1%85-%d0%b4%d0%bb%d1%8f-%d1%81%d0%b5%d1%82%d0%b8-sigil-gate\" aria-label=\"Якорь\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h1\u003e\u003cp\u003eЭтот документ описывает архитектуру, выбранную для организации распределенного и надежного хранения данных сети Sigil Gate. Он охватывает проблему, постановку задачи, рассмотренные альтернативы, итоговое решение, его компоненты, механизмы синхронизации и дорожную карту развития.\u003c/p\u003e\n\u003ch2 id=\"оглавление\" class=\"relative group\"\u003eОглавление \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#%d0%be%d0%b3%d0%bb%d0%b0%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5\" aria-label=\"Якорь\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h2\u003e\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#00_introduction\"\u003eВведение: Проблема, Цели и Ограничения\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#01_alternative_solutions\"\u003eРассмотренные Альтернативные Решения\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#02_final_architecture\"\u003eИтоговая Архитектура: Гибридный Подход\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#03_components\"\u003eКомпоненты Системы\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#03_components/kv_cluster\"\u003eКластер Key-Value Хранилища\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#03_components/git_repository\"\u003eРепозиторий Git как Источник Истины\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#03_components/node_interactions\"\u003eВзаимодействие Узлов с Хранилищами\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#04_synchronization_and_consistency\"\u003eСинхронизация Данных и Обеспечение Консистентности\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#05_roadmap\"\u003eДорожная Карта Развития\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Архитектура хранения данных"},{"content":"00 Введение: Проблема, Цели и Ограничения #Проект Sigil Gate ставит перед собой задачу создания децентрализованной частной сети, устойчивой к современным методам обнаружения и блокировки, таким как глубокий анализ пакетов (DPI) и активное зондирование. В рамках этой глобальной цели возникает критически важная подзадача, касающаяся хранения и синхронизации данных о сущностях сети.\n1. Проблема #Необходимо разработать систему хранения данных, которая способна поддерживать работу распределенной и децентрализованной сети, обеспечивая при этом высокую доступность и консистентность конфигурационной и оперативной информации. Традиционные централизованные подходы к хранению данных создают единую точку отказа, что противоречит основополагающим принципам устойчивости сети Sigil Gate.\n2. Постановка Задачи #Разработать архитектуру хранения данных для сети Sigil Gate, которая позволит:\nРаспределенное и доступное хранение: Информация о всех сущностях сети (узлах, их конфигурациях, маршрутах, пользователях и т.д.) должна быть доступна из любого рабочего сегмента сети. Высокая отказоустойчивость: Сеть должна продолжать стабильно функционировать до тех пор, пока доступны хотя бы две ноды — одна входная нода (Entry-нода) и одна нода ядра (Core-нода). Регулярная синхронизация: Обеспечить непрерывную синхронизацию информации между различными местами хранения для поддержания актуального состояния сети. Сохранность данных при компрометации/перестроении: Гарантировать отсутствие потери информации даже при полной компрометации сети в плоскости данных и необходимости полного перестроения топологии (уничтожения всех узлов и выстраивания сети с нуля). Полная автоматизация управления: Создать условия для программного управления всеми функциями сети — через CLI или будущий веб-интерфейс. 3. Условия и Ограничения # Размер сети: Сеть планируется небольшого объема — десятки и сотни узлов. В редких случаях размер сети может превышать 1000 узлов. Иерархия управления: В плоскости управления должна существовать строгая вертикальная иерархия. Все управление строго подчинено Root-ноде. Оперативное управление (ротация узлов, ротация путей, управление параметрами соединений, управление пользователями) может осуществляться с любой Core-ноды. Роль Root-ноды: Root-нода может быть неактивной в течение длительного времени. Её задачи ограничены развертыванием сети, выпуском корневых сертификатов и реагированием на критические инциденты (например, отзыв сертификатов). Она не используется для оперативного управления. Начальное размещение KV-кластера: На начальном этапе, учитывая небольшой размер сети, кластер Key-Value хранилища будет развернут непосредственно на Core-нодах. Отдельный выделенный KV-кластер может быть рассмотрен по мере роста проекта. Доступ Core-нод к Git: Для обеспечения непрерывной синхронизации, все Core-ноды будут иметь доступ к записи в приватный Git-репозиторий для периодического сохранения оперативных изменений. ","date":"1 января 1 г.","permalink":"https://sigilgate.github.io/docs/data_storage/00_introduction/","section":"Документация","summary":"\u003ch1 id=\"00-введение-проблема-цели-и-ограничения\" class=\"relative group\"\u003e00 Введение: Проблема, Цели и Ограничения \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#00-%d0%b2%d0%b2%d0%b5%d0%b4%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bf%d1%80%d0%be%d0%b1%d0%bb%d0%b5%d0%bc%d0%b0-%d1%86%d0%b5%d0%bb%d0%b8-%d0%b8-%d0%be%d0%b3%d1%80%d0%b0%d0%bd%d0%b8%d1%87%d0%b5%d0%bd%d0%b8%d1%8f\" aria-label=\"Якорь\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h1\u003e\u003cp\u003eПроект Sigil Gate ставит перед собой задачу создания децентрализованной частной сети, устойчивой к современным методам обнаружения и блокировки, таким как глубокий анализ пакетов (DPI) и активное зондирование. В рамках этой глобальной цели возникает критически важная подзадача, касающаяся хранения и синхронизации данных о сущностях сети.\u003c/p\u003e\n\u003ch2 id=\"1-проблема\" class=\"relative group\"\u003e1. Проблема \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#1-%d0%bf%d1%80%d0%be%d0%b1%d0%bb%d0%b5%d0%bc%d0%b0\" aria-label=\"Якорь\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h2\u003e\u003cp\u003eНеобходимо разработать систему хранения данных, которая способна поддерживать работу распределенной и децентрализованной сети, обеспечивая при этом высокую доступность и консистентность конфигурационной и оперативной информации. Традиционные централизованные подходы к хранению данных создают единую точку отказа, что противоречит основополагающим принципам устойчивости сети Sigil Gate.\u003c/p\u003e","title":"Введение: Проблема, Цели и Ограничения"},{"content":"03.3 Взаимодействие Узлов с Хранилищами #Различные типы узлов в сети Sigil Gate имеют специфические роли и, следовательно, различающиеся права доступа и механизмы взаимодействия с распределенным Key-Value (KV) хранилищем и Git-репозиторием.\n1. Root-нода #Root-нода является центром управления и доверия в сети. Её взаимодействие с хранилищами сосредоточено на критически важных функциях.\nДоступ к KV-хранилищу: Полные права на чтение и запись. Используется для инициализации KV-кластера, внесения глобальных изменений и реагирования на инциденты. Доступ к Git-репозиторию: Полные права на чтение и запись. При развертывании или полном восстановлении сети Root-нода извлекает желаемую конфигурацию из Git. Она также может быть задействована для периодической сверки состояния KV-хранилища с Git и фиксации изменений (хотя основная оперативная синхронизация делегируется Core-нодам). Основные задачи: Инициирование развертывания новой сети или полного восстановления. Управление инфраструктурой открытых ключей (PKI), включая выпуск корневых и промежуточных сертификатов. Реагирование на критические инциденты, такие как компрометация узлов или отзыв сертификатов. Особенность: Root-нода может быть неактивной в течение длительного времени, активируясь только для выполнения своих специфических задач. 2. Core-ноды #Core-ноды являются ядром сети и несут основную нагрузку по оперативному управлению и поддержанию её работоспособности. На начальном этапе они также хостят KV-кластер.\nДоступ к KV-хранилищу: Права на чтение всех необходимых конфигураций и оперативных состояний. Ограниченные права на запись для выполнения оперативных изменений, таких как: Обновление статусов Entry-нод. Инициирование ротации gRPC-путей для своих Entry-нод. Управление пользовательскими данными (добавление, изменение, удаление пользователей). Обновление конфигураций, связанных с их собственным функционированием. Доступ к Git-репозиторию: Полные права на запись. Это ключевое отличие от Root-ноды в контексте оперативной синхронизации. Core-ноды отвечают за периодическое сохранение оперативных изменений, произошедших в KV-хранилище, обратно в Git-репозиторий. Это обеспечивает непрерывное версионирование и сохранение актуального состояния сети, даже когда Root-нода неактивна. Основные задачи: Маршрутизация трафика в Интернет. Управление своими привязанными Entry-нодами. Выполнение оперативных изменений в сети. Хостинг узлов KV-кластера (на начальном этапе). Непрерывная синхронизация оперативного состояния в Git. 3. Entry-ноды #Entry-ноды являются периферийными узлами, принимающими клиентские подключения. Их взаимодействие с хранилищами является наиболее ограниченным и сфокусировано на получении своей рабочей конфигурации.\nДоступ к KV-хранилищу: Только права на чтение. Entry-ноды извлекают из KV-кластера необходимую информацию для своей работы, включая: Свою конфигурацию. Актуальные gRPC-пути и параметры подключений к Core-нодам. Данные для аутентификации клиентов. Доступ к Git-репозиторию: Отсутствует. Entry-ноды не взаимодействуют напрямую с Git-репозиторием. Основные задачи: Прием клиентских подключений. Маскировка трафика под легитимную HTTPS-активность. Перенаправление трафика на Core-ноды. Такое разделение прав и обязанностей обеспечивает необходимый баланс между централизованным контролем (Root-нода и Git как источник истины) и децентрализованным оперативным управлением (Core-ноды и KV-хранилище), а также минимизирует риски при компрометации периферийных узлов.\n","date":"1 января 1 г.","permalink":"https://sigilgate.github.io/docs/data_storage/03_components/node_interactions/","section":"Документация","summary":"\u003ch1 id=\"033-взаимодействие-узлов-с-хранилищами\" class=\"relative group\"\u003e03.3 Взаимодействие Узлов с Хранилищами \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#033-%d0%b2%d0%b7%d0%b0%d0%b8%d0%bc%d0%be%d0%b4%d0%b5%d0%b9%d1%81%d1%82%d0%b2%d0%b8%d0%b5-%d1%83%d0%b7%d0%bb%d0%be%d0%b2-%d1%81-%d1%85%d1%80%d0%b0%d0%bd%d0%b8%d0%bb%d0%b8%d1%89%d0%b0%d0%bc%d0%b8\" aria-label=\"Якорь\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h1\u003e\u003cp\u003eРазличные типы узлов в сети Sigil Gate имеют специфические роли и, следовательно, различающиеся права доступа и механизмы взаимодействия с распределенным Key-Value (KV) хранилищем и Git-репозиторием.\u003c/p\u003e\n\u003ch2 id=\"1-root-нода\" class=\"relative group\"\u003e1. Root-нода \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#1-root-%d0%bd%d0%be%d0%b4%d0%b0\" aria-label=\"Якорь\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h2\u003e\u003cp\u003eRoot-нода является центром управления и доверия в сети. Её взаимодействие с хранилищами сосредоточено на критически важных функциях.\u003c/p\u003e","title":"Взаимодействие Узлов с Хранилищами"},{"content":"05 Дорожная Карта Развития #Развитие архитектуры хранения данных для сети Sigil Gate будет осуществляться поэтапно, с учетом текущих потребностей и перспективного роста проекта. Это позволит эффективно использовать ресурсы и масштабировать систему по мере увеличения требований.\n1. Этап 1: Начальное Внедрение (Текущий этап) # KV-хранилище: Развертывание кластера etcd непосредственно на Core-нодах. Core-ноды будут хостить узлы etcd, обеспечивая оперативность и распределенность хранения конфигураций и состояний. Git-репозиторий: Создание приватного Git-репозитория для хранения желаемого состояния сети и её конфигураций. Этот репозиторий будет служить источником истины и основным механизмом восстановления. Синхронизация: Реализация механизмов синхронизации: Root-нода для первоначальной загрузки конфигурации из Git в etcd при развертывании. Core-ноды для периодического сохранения оперативных изменений из etcd обратно в Git. Управление доступом: Настройка ACL для etcd и прав доступа для Git-репозитория, обеспечивающих необходимую иерархию управления и безопасность. Автоматизация: Разработка базовых CLI-инструментов для взаимодействия с etcd и Git-репозиторием для выполнения оперативного управления. 2. Этап 2: Масштабирование и Оптимизация (По мере роста сети) # Выделенный KV-кластер: При значительном росте числа узлов (ближе к сотням и тысячам), увеличении нагрузки на Core-ноды или необходимости повышения изоляции, будет рассмотрено развертывание выделенного кластера etcd на отдельных, специализированных узлах. Это позволит разгрузить Core-ноды и повысить общую доступность и производительность KV-хранилища. Миграция на Consul (опционально): Если возникнет потребность в расширенных функциях Service Discovery, Health Checking или других возможностях, присущих Consul, будет рассмотрена миграция с etcd на Consul. Этот переход будет планироваться таким образом, чтобы минимизировать простой и обеспечить плавность перехода. Расширение автоматизации: Разработка более сложных CLI-инструментов и, возможно, создание веб-интерфейса для управления сетью, использующего API KV-хранилища и взаимодействующего с Git. Улучшение мониторинга: Развертывание комплексной системы мониторинга и алертинга для отслеживания состояния KV-кластера, процессов синхронизации и консистентности данных. 3. Этап 3: Расширенные Возможности и Устойчивость # Геораспределенный KV-кластер: Для максимальной отказоустойчивости и снижения задержек в очень больших или географически распределенных сетях может быть рассмотрено развертывание геораспределенного KV-кластера. Интеграция с CI/CD: Более глубокая интеграция Git-репозитория с пайплайнами CI/CD для автоматизированного тестирования конфигураций перед их применением. Автоматическое разрешение конфликтов: Разработка более продвинутых механизмов для автоматического разрешения конфликтов при параллельной записи в Git-репозиторий несколькими Core-нодами, если это станет значительной проблемой. Эта дорожная карта обеспечивает гибкость в развитии архитектуры хранения данных, позволяя проекту Sigil Gate адаптироваться к изменяющимся условиям и требованиям, сохраняя при этом основные принципы надежности и децентрализации.\n","date":"1 января 1 г.","permalink":"https://sigilgate.github.io/docs/data_storage/05_roadmap/","section":"Документация","summary":"\u003ch1 id=\"05-дорожная-карта-развития\" class=\"relative group\"\u003e05 Дорожная Карта Развития \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#05-%d0%b4%d0%be%d1%80%d0%be%d0%b6%d0%bd%d0%b0%d1%8f-%d0%ba%d0%b0%d1%80%d1%82%d0%b0-%d1%80%d0%b0%d0%b7%d0%b2%d0%b8%d1%82%d0%b8%d1%8f\" aria-label=\"Якорь\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h1\u003e\u003cp\u003eРазвитие архитектуры хранения данных для сети Sigil Gate будет осуществляться поэтапно, с учетом текущих потребностей и перспективного роста проекта. Это позволит эффективно использовать ресурсы и масштабировать систему по мере увеличения требований.\u003c/p\u003e\n\u003ch2 id=\"1-этап-1-начальное-внедрение-текущий-этап\" class=\"relative group\"\u003e1. Этап 1: Начальное Внедрение (Текущий этап) \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#1-%d1%8d%d1%82%d0%b0%d0%bf-1-%d0%bd%d0%b0%d1%87%d0%b0%d0%bb%d1%8c%d0%bd%d0%be%d0%b5-%d0%b2%d0%bd%d0%b5%d0%b4%d1%80%d0%b5%d0%bd%d0%b8%d0%b5-%d1%82%d0%b5%d0%ba%d1%83%d1%89%d0%b8%d0%b9-%d1%8d%d1%82%d0%b0%d0%bf\" aria-label=\"Якорь\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h2\u003e\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eKV-хранилище:\u003c/strong\u003e Развертывание кластера \u003ccode\u003eetcd\u003c/code\u003e непосредственно на Core-нодах. Core-ноды будут хостить узлы \u003ccode\u003eetcd\u003c/code\u003e, обеспечивая оперативность и распределенность хранения конфигураций и состояний.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eGit-репозиторий:\u003c/strong\u003e Создание приватного Git-репозитория для хранения желаемого состояния сети и её конфигураций. Этот репозиторий будет служить источником истины и основным механизмом восстановления.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eСинхронизация:\u003c/strong\u003e Реализация механизмов синхронизации:\n\u003cul\u003e\n\u003cli\u003eRoot-нода для первоначальной загрузки конфигурации из Git в \u003ccode\u003eetcd\u003c/code\u003e при развертывании.\u003c/li\u003e\n\u003cli\u003eCore-ноды для периодического сохранения оперативных изменений из \u003ccode\u003eetcd\u003c/code\u003e обратно в Git.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eУправление доступом:\u003c/strong\u003e Настройка ACL для \u003ccode\u003eetcd\u003c/code\u003e и прав доступа для Git-репозитория, обеспечивающих необходимую иерархию управления и безопасность.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eАвтоматизация:\u003c/strong\u003e Разработка базовых CLI-инструментов для взаимодействия с \u003ccode\u003eetcd\u003c/code\u003e и Git-репозиторием для выполнения оперативного управления.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"2-этап-2-масштабирование-и-оптимизация-по-мере-роста-сети\" class=\"relative group\"\u003e2. Этап 2: Масштабирование и Оптимизация (По мере роста сети) \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#2-%d1%8d%d1%82%d0%b0%d0%bf-2-%d0%bc%d0%b0%d1%81%d1%88%d1%82%d0%b0%d0%b1%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-%d0%b8-%d0%be%d0%bf%d1%82%d0%b8%d0%bc%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f-%d0%bf%d0%be-%d0%bc%d0%b5%d1%80%d0%b5-%d1%80%d0%be%d1%81%d1%82%d0%b0-%d1%81%d0%b5%d1%82%d0%b8\" aria-label=\"Якорь\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h2\u003e\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eВыделенный KV-кластер:\u003c/strong\u003e При значительном росте числа узлов (ближе к сотням и тысячам), увеличении нагрузки на Core-ноды или необходимости повышения изоляции, будет рассмотрено развертывание выделенного кластера \u003ccode\u003eetcd\u003c/code\u003e на отдельных, специализированных узлах. Это позволит разгрузить Core-ноды и повысить общую доступность и производительность KV-хранилища.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eМиграция на \u003ccode\u003eConsul\u003c/code\u003e (опционально):\u003c/strong\u003e Если возникнет потребность в расширенных функциях Service Discovery, Health Checking или других возможностях, присущих \u003ccode\u003eConsul\u003c/code\u003e, будет рассмотрена миграция с \u003ccode\u003eetcd\u003c/code\u003e на \u003ccode\u003eConsul\u003c/code\u003e. Этот переход будет планироваться таким образом, чтобы минимизировать простой и обеспечить плавность перехода.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eРасширение автоматизации:\u003c/strong\u003e Разработка более сложных CLI-инструментов и, возможно, создание веб-интерфейса для управления сетью, использующего API KV-хранилища и взаимодействующего с Git.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eУлучшение мониторинга:\u003c/strong\u003e Развертывание комплексной системы мониторинга и алертинга для отслеживания состояния KV-кластера, процессов синхронизации и консистентности данных.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"3-этап-3-расширенные-возможности-и-устойчивость\" class=\"relative group\"\u003e3. Этап 3: Расширенные Возможности и Устойчивость \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#3-%d1%8d%d1%82%d0%b0%d0%bf-3-%d1%80%d0%b0%d1%81%d1%88%d0%b8%d1%80%d0%b5%d0%bd%d0%bd%d1%8b%d0%b5-%d0%b2%d0%be%d0%b7%d0%bc%d0%be%d0%b6%d0%bd%d0%be%d1%81%d1%82%d0%b8-%d0%b8-%d1%83%d1%81%d1%82%d0%be%d0%b9%d1%87%d0%b8%d0%b2%d0%be%d1%81%d1%82%d1%8c\" aria-label=\"Якорь\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h2\u003e\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eГеораспределенный KV-кластер:\u003c/strong\u003e Для максимальной отказоустойчивости и снижения задержек в очень больших или географически распределенных сетях может быть рассмотрено развертывание геораспределенного KV-кластера.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eИнтеграция с CI/CD:\u003c/strong\u003e Более глубокая интеграция Git-репозитория с пайплайнами CI/CD для автоматизированного тестирования конфигураций перед их применением.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eАвтоматическое разрешение конфликтов:\u003c/strong\u003e Разработка более продвинутых механизмов для автоматического разрешения конфликтов при параллельной записи в Git-репозиторий несколькими Core-нодами, если это станет значительной проблемой.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eЭта дорожная карта обеспечивает гибкость в развитии архитектуры хранения данных, позволяя проекту Sigil Gate адаптироваться к изменяющимся условиям и требованиям, сохраняя при этом основные принципы надежности и децентрализации.\u003c/p\u003e","title":"Дорожная Карта Развития"},{"content":"02 Итоговая Архитектура: Гибридный Подход #Для удовлетворения всех требований по распределенному хранению, отказоустойчивости, консистентности, автоматизации и, главное, сохранности данных при полном перестроении сети Sigil Gate, была выбрана гибридная архитектура. Она сочетает в себе преимущества распределенного Key-Value (KV) хранилища для оперативных данных и системы контроля версий Git как основного источника истины и средства восстановления.\n1. Обзор Гибридной Архитектуры #Этот подход разделяет функции хранения данных на две основные категории:\nОперативное хранение (KV-хранилище): Обеспечивает высокую доступность и строгую консистентность текущего состояния сети в реальном времени. Используется для быстрого чтения и записи конфигураций, статусов и оперативных параметров. Долгосрочное хранение и источник истины (Git-репозиторий): Служит единственным достоверным источником желаемого состояния всей сети. Гарантирует версионирование, аудит изменений и возможность полного восстановления инфраструктуры с нуля. Диаграмма взаимодействия (высокоуровневая) #graph TD GitRepo[Приватный Git-репозиторий\u0026lt;br/\u0026gt;\u0026lt;small\u0026gt;Источник истины, версионирование, бэкап\u0026lt;/small\u0026gt;] KVStore[Распределенный KV-кластер\u0026lt;br/\u0026gt;\u0026lt;small\u0026gt;Оперативные данные, высокая доступность, консистентность\u0026lt;/small\u0026gt;] RootNode[Root-нода\u0026lt;br/\u0026gt;\u0026lt;small\u0026gt;Развертывание, PKI, инциденты, синхронизация\u0026lt;/small\u0026gt;] CoreNodes[Core-ноды\u0026lt;br/\u0026gt;\u0026lt;small\u0026gt;Оперативное управление, синхронизация, хостинг KV-кластера\u0026lt;/small\u0026gt;] EntryNodes[Entry-ноды\u0026lt;br/\u0026gt;\u0026lt;small\u0026gt;Чтение конфигураций\u0026lt;/small\u0026gt;] Automation[Автоматизация\u0026lt;br/\u0026gt;\u0026lt;small\u0026gt;(CLI/API)\u0026lt;/small\u0026gt;] GitRepo -- \u0026#34;Пуш/Пулл изменений\u0026#34; --\u0026gt; CoreNodes GitRepo -- \u0026#34;Пуш/Пулл изменений\u0026#34; --\u0026gt; RootNode CoreNodes -- \u0026#34;Чтение/Запись\u0026#34; --\u0026gt; KVStore RootNode -- \u0026#34;Чтение/Запись\u0026#34; --\u0026gt; KVStore EntryNodes -- \u0026#34;Чтение\u0026#34; --\u0026gt; KVStore Automation -- \u0026#34;Управление\u0026#34; --\u0026gt; CoreNodes Automation -- \u0026#34;Управление\u0026#34; --\u0026gt; RootNode 2. Ключевые Принципы Архитектуры # Распределенность и Отказоустойчивость: KV-кластер, размещенный на Core-нодах, обеспечивает распределенное хранение и устойчивость к отказу отдельных узлов. Сеть продолжает работать, пока есть как минимум одна Core-нода и одна Entry-нода, способные взаимодействовать с KV-кластером. Иерархия Управления: Root-нода сохраняет высший уровень контроля, отвечая за развертывание и реагирование на инциденты. Core-ноды получают полномочия для оперативного управления (ротация, управление параметрами, пользователи), взаимодействуя с KV-хранилищем. Автоматизация: Благодаря API KV-хранилища и четкой структуре данных, все управленческие функции могут быть полностью автоматизированы и реализованы через CLI или будущие веб-интерфейсы. Сохранность Данных: Git-репозиторий гарантирует, что желаемое состояние сети всегда сохранено и может быть использовано для полного восстановления даже после катастрофического сбоя, уничтожившего все оперативные узлы и KV-кластер. Консистентность: Распределенное KV-хранилище (например, etcd) обеспечивает строгую консистентность оперативных данных, а механизмы синхронизации поддерживают согласованность между KV и Git. Подробное описание каждого компонента и механизмов их взаимодействия представлено в следующих разделах.\n","date":"1 января 1 г.","permalink":"https://sigilgate.github.io/docs/data_storage/02_final_architecture/","section":"Документация","summary":"\u003ch1 id=\"02-итоговая-архитектура-гибридный-подход\" class=\"relative group\"\u003e02 Итоговая Архитектура: Гибридный Подход \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#02-%d0%b8%d1%82%d0%be%d0%b3%d0%be%d0%b2%d0%b0%d1%8f-%d0%b0%d1%80%d1%85%d0%b8%d1%82%d0%b5%d0%ba%d1%82%d1%83%d1%80%d0%b0-%d0%b3%d0%b8%d0%b1%d1%80%d0%b8%d0%b4%d0%bd%d1%8b%d0%b9-%d0%bf%d0%be%d0%b4%d1%85%d0%be%d0%b4\" aria-label=\"Якорь\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h1\u003e\u003cp\u003eДля удовлетворения всех требований по распределенному хранению, отказоустойчивости, консистентности, автоматизации и, главное, сохранности данных при полном перестроении сети Sigil Gate, была выбрана \u003cstrong\u003eгибридная архитектура\u003c/strong\u003e. Она сочетает в себе преимущества \u003cstrong\u003eраспределенного Key-Value (KV) хранилища\u003c/strong\u003e для оперативных данных и \u003cstrong\u003eсистемы контроля версий Git\u003c/strong\u003e как основного источника истины и средства восстановления.\u003c/p\u003e\n\u003ch2 id=\"1-обзор-гибридной-архитектуры\" class=\"relative group\"\u003e1. Обзор Гибридной Архитектуры \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#1-%d0%be%d0%b1%d0%b7%d0%be%d1%80-%d0%b3%d0%b8%d0%b1%d1%80%d0%b8%d0%b4%d0%bd%d0%be%d0%b9-%d0%b0%d1%80%d1%85%d0%b8%d1%82%d0%b5%d0%ba%d1%82%d1%83%d1%80%d1%8b\" aria-label=\"Якорь\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h2\u003e\u003cp\u003eЭтот подход разделяет функции хранения данных на две основные категории:\u003c/p\u003e","title":"Итоговая Архитектура: Гибридный Подход"},{"content":"03.1 Кластер Key-Value Хранилища #Распределенное Key-Value (KV) хранилище является основой для оперативного управления и поддержания текущего состояния сети Sigil Gate. Оно обеспечивает быстрый доступ к конфигурациям, статусам узлов и другим динамически изменяющимся параметрам.\n1. Выбор Технологии (Начальный Этап) #На начальном этапе проекта выбран etcd в качестве основного KV-хранилища. etcd хорошо зарекомендовал себя в крупных распределенных системах (например, Kubernetes) благодаря своей простоте, высокой производительности и надежности в обеспечении строгой консистентности данных.\n2. Роль в Архитектуре #KV-кластер служит для хранения всех оперативных данных и текущего состояния сети. Это включает в себя:\nКонфигурации узлов: Актуальные настройки для Root-, Core- и Entry-нод. Статусы узлов: Информация о работоспособности, активности и текущих параметрах каждого узла. Маршруты и параметры соединений: Динамические пути gRPC, параметры TLS и другая информация, необходимая для установления и поддержания соединений. Данные пользователей: Информация о пользователях, их доступах и учетных данных (в хешированном виде). Топология сети: Текущие связи между Core-нодами и привязки Entry-нод к Core-нодам. 3. Размещение Кластера (Начальный Этап) #На начальном этапе, учитывая небольшой размер сети и для оптимизации ресурсов, кластер etcd будет развернут непосредственно на Core-нодах. Каждая Core-нода будет являться частью этого распределенного KV-кластера.\nПреимущества такого подхода на начальном этапе: # Минимизация инфраструктуры: Не требует выделения дополнительных серверов для KV-хранилища. Упрощение развертывания: Интеграция etcd с Core-нодами уменьшает сложность начальной установки. Ограничения и Дальнейшее Развитие: # Связь доступности: Доступность KV-хранилища напрямую зависит от доступности Core-нод. Сбой Core-ноды может повлиять на весь кластер. Масштабирование: По мере роста сети и увеличения нагрузки на Core-ноды, или при необходимости более высокой изоляции, будет рассмотрен переход на выделенный кластер KV-хранилища на отдельных узлах (см. Дорожная Карта Развития). 4. Доступность и Отказоустойчивость #Кластер etcd (как и Consul в будущем) построен на протоколах консенсуса (например, Raft), что обеспечивает строгую консистентность и высокую доступность. Кластер из нечетного числа узлов (например, 3 или 5) способен пережить отказ до (N-1)/2 узлов, сохраняя работоспособность.\n5. Управление Доступом (ACL) #Будет настроена система контроля доступа (ACL) для взаимодействия с KV-кластером:\nRoot-нода: Имеет полные права на чтение и запись всех данных в KV-кластере. Core-ноды: Имеют права на чтение всех необходимых конфигураций и состояний. Права на запись будут ограничены для оперативных изменений (например, обновление статусов Entry-нод, инициирование ротации путей) и управления пользовательскими данными. Entry-ноды: Имеют только права на чтение своих собственных конфигураций и актуальных маршрутов. Им запрещено записывать данные в KV-кластер напрямую. 6. API для Автоматизации #KV-хранилище предоставляет удобный API (HTTP/gRPC), который будет использоваться для программного управления сетью. Это обеспечит основу для создания инструментов CLI и будущих веб-интерфейсов, позволяющих автоматизировать все аспекты оперативного управления.\n","date":"1 января 1 г.","permalink":"https://sigilgate.github.io/docs/data_storage/03_components/kv_cluster/","section":"Документация","summary":"\u003ch1 id=\"031-кластер-key-value-хранилища\" class=\"relative group\"\u003e03.1 Кластер Key-Value Хранилища \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#031-%d0%ba%d0%bb%d0%b0%d1%81%d1%82%d0%b5%d1%80-key-value-%d1%85%d1%80%d0%b0%d0%bd%d0%b8%d0%bb%d0%b8%d1%89%d0%b0\" aria-label=\"Якорь\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h1\u003e\u003cp\u003eРаспределенное Key-Value (KV) хранилище является основой для оперативного управления и поддержания текущего состояния сети Sigil Gate. Оно обеспечивает быстрый доступ к конфигурациям, статусам узлов и другим динамически изменяющимся параметрам.\u003c/p\u003e\n\u003ch2 id=\"1-выбор-технологии-начальный-этап\" class=\"relative group\"\u003e1. Выбор Технологии (Начальный Этап) \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#1-%d0%b2%d1%8b%d0%b1%d0%be%d1%80-%d1%82%d0%b5%d1%85%d0%bd%d0%be%d0%bb%d0%be%d0%b3%d0%b8%d0%b8-%d0%bd%d0%b0%d1%87%d0%b0%d0%bb%d1%8c%d0%bd%d1%8b%d0%b9-%d1%8d%d1%82%d0%b0%d0%bf\" aria-label=\"Якорь\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h2\u003e\u003cp\u003eНа начальном этапе проекта выбран \u003ccode\u003eetcd\u003c/code\u003e в качестве основного KV-хранилища. \u003ccode\u003eetcd\u003c/code\u003e хорошо зарекомендовал себя в крупных распределенных системах (например, Kubernetes) благодаря своей простоте, высокой производительности и надежности в обеспечении строгой консистентности данных.\u003c/p\u003e","title":"Кластер Key-Value Хранилища"},{"content":"03 Компоненты Системы Хранения Данных #Архитектура хранения данных сети Sigil Gate основана на двух ключевых компонентах: распределенном Key-Value (KV) хранилище и Git-репозитории. Каждый из этих компонентов играет уникальную роль в обеспечении надежности, доступности и управляемости данных.\nОглавление раздела \u0026ldquo;Компоненты Системы\u0026rdquo; # Кластер Key-Value Хранилища Репозиторий Git как Источник Истины Взаимодействие Узлов с Хранилищами ","date":null,"permalink":"https://sigilgate.github.io/docs/data_storage/03_components/","section":"Документация","summary":"\u003ch1 id=\"03-компоненты-системы-хранения-данных\" class=\"relative group\"\u003e03 Компоненты Системы Хранения Данных \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#03-%d0%ba%d0%be%d0%bc%d0%bf%d0%be%d0%bd%d0%b5%d0%bd%d1%82%d1%8b-%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d1%8b-%d1%85%d1%80%d0%b0%d0%bd%d0%b5%d0%bd%d0%b8%d1%8f-%d0%b4%d0%b0%d0%bd%d0%bd%d1%8b%d1%85\" aria-label=\"Якорь\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h1\u003e\u003cp\u003eАрхитектура хранения данных сети Sigil Gate основана на двух ключевых компонентах: распределенном Key-Value (KV) хранилище и Git-репозитории. Каждый из этих компонентов играет уникальную роль в обеспечении надежности, доступности и управляемости данных.\u003c/p\u003e\n\u003ch2 id=\"оглавление-раздела-компоненты-системы\" class=\"relative group\"\u003eОглавление раздела \u0026ldquo;Компоненты Системы\u0026rdquo; \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#%d0%be%d0%b3%d0%bb%d0%b0%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d1%80%d0%b0%d0%b7%d0%b4%d0%b5%d0%bb%d0%b0-%d0%ba%d0%be%d0%bc%d0%bf%d0%be%d0%bd%d0%b5%d0%bd%d1%82%d1%8b-%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d1%8b\" aria-label=\"Якорь\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h2\u003e\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#03_components/kv_cluster\"\u003eКластер Key-Value Хранилища\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#03_components/git_repository\"\u003eРепозиторий Git как Источник Истины\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#03_components/node_interactions\"\u003eВзаимодействие Узлов с Хранилищами\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Компоненты Системы Хранения Данных"},{"content":"Sigil Gate — проект, посвященный построению приватных сетей, устойчивых к обнаружению средствами глубокого анализа трафика (DPI), активному зондированию и региональным блокировкам.\nSigil Gate является частично открытым проектом. Мы открыто публикуем общую архитектуру, инструменты широкого назначения и делимся опытом в блоге. В то же время значительная часть проекта остается закрытой: конфигурации конкретных узлов, чувствительные данные инфраструктуры и специфические детали организации сети не предназначены для публичного доступа.\nПри этом мы открыты к диалогу с сообществом и готовы обсуждать:\nархитектурные подходы к проектированию приватных сетей; работу протоколов и транспортов; модели угроз и уязвимости частных сетей; методы защиты от обнаружения средствами DPI и активного зондирования. Мы также стремимся выкладывать в open-source инструменты общего назначения, решающие задачи мониторинга, автоматизации и системного администрирования.\nМиссия #Мы верим в ценность свободного доступа к открытой информации. Ограничения интернета затрагивают интересы миллионов людей по всему миру, и мы хотим внести свой вклад в решение этой проблемы. Мы стремимся создать открытое комьюнити для свободного обсуждения проблемы ограничений, обмена опытом и поиска решений.\nЦели и задачи #Цели #Создание децентрализованной сетевой архитектуры, которая:\nустойчива к обнаружению; маскирует трафик под легитимную HTTPS-активность на всех участках сети; сохраняет работоспособность при блокировке или компрометации отдельных узлов; масштабируется и адаптируется к изменяющимся условиям. Задачи #Основная практическая задача — развертывание инфраструктуры для частной сети, построенной на описанных принципах, для ограниченного круга участников.\nВ перспективе:\nкоммерческое применение полученного опыта и наработок; оказание независимых услуг по проектированию и настройке защищенных сетей; консалтинг в области сетевой безопасности и инфраструктурных решений; разработка инструментов и утилит для сетевого администрирования и удаленного доступа к ресурсам. Статус проекта #Проект находится на ранней стадии активной разработки. Sigil Gate вырос из нескольких pet-проектов, связанных с построением приватных сетей для персонального использования, и сейчас оформляется в самостоятельный проект с долгосрочными целями.\nБазовая инфраструктура развернута и функционирует. Ведется работа над документацией, инструментами автоматизации и расширением сети.\nКоманда #Основатель организации Sigil Gate на GitHub и главная движущая сила проекта:\nA1eksMa (при поддержке всех сочувствующих и заинтересованных) Весомый вклад в развитие проекта также вносят Клод (из компании Anthropic) и Джим (из Google), также известные как:\n\u0026ldquo;Claude Code\u0026rdquo; \u0026ldquo;Gemini CLI\u0026rdquo; Мы будем рады каждому, кто захочет присоединиться к проекту — в любой роли и на любом уровне вовлеченности.\nУчастие в проекте #Есть несколько способов принять участие:\nПрисоединиться к обсуждению в Telegram или Discord. Открыть issue в одном из репозиториев на GitHub. Предложить pull request — мы открыты к вкладу в публичные репозитории. Поделиться опытом — написать в блог, предложить тему для исследования, сообщить о проблеме. Контакты # GitHub Telegram Блог ","date":"1 января 1 г.","permalink":"https://sigilgate.github.io/about/","section":"Sigil Gate","summary":"\u003cp\u003e\u003cstrong\u003eSigil Gate\u003c/strong\u003e — проект, посвященный построению приватных сетей, устойчивых к обнаружению средствами глубокого анализа трафика (DPI), активному зондированию и региональным блокировкам.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eSigil Gate\u003c/strong\u003e является \u003cstrong\u003eчастично открытым\u003c/strong\u003e проектом. Мы открыто публикуем общую архитектуру, инструменты широкого назначения и делимся опытом в \n      \n    \u003ca href=\"https://sigilgate.github.io/blog/\"\u003eблоге\u003c/a\u003e. В то же время значительная часть проекта остается закрытой: конфигурации конкретных узлов, чувствительные данные инфраструктуры и специфические детали организации сети не предназначены для публичного доступа.\u003c/p\u003e\n\u003cp\u003eПри этом мы открыты к диалогу с сообществом и готовы обсуждать:\u003c/p\u003e","title":"О проекте"},{"content":"01 Рассмотренные Альтернативные Решения #При поиске оптимальной архитектуры для хранения данных сети Sigil Gate были рассмотрены различные подходы. Основными критериями оценки были отказоустойчивость, распределенность, консистентность, удобство автоматизации и возможность полного восстановления данных при катастрофических сбоях.\n1. Файловая Система на Каждом Узле #Описание: Хранение конфигураций и оперативных данных в файлах (например, JSON, YAML) непосредственно на каждом узле сети.\nПреимущества:\nПростота реализации на начальном этапе. Низкие накладные расходы на развертывание дополнительной инфраструктуры. Недостатки и Причины Отклонения:\nОтсутствие консистентности: Обеспечение строгой консистентности данных между файлами на разных узлах становится крайне сложным, особенно в распределенной среде с возможными сетевыми задержками и отказами. Сложность синхронизации: Требуется разработка сложного механизма синхронизации (например, с использованием протоколов консенсуса или gossip), что фактически приводит к созданию распределенной системы хранения, но без готовых инструментов. Проблемы с отказоустойчивостью: При выходе из строя узла данные, которые не были синхронизированы, могут быть потеряны. Восстановление данных требует ручной работы или сложных процедур бэкапа. Восстановление сети с нуля: При полной компрометации или уничтожении сети, восстановление данных из разрозненных файлов на множестве узлов крайне затруднительно и ненадежно. 2. Традиционные Реляционные Базы Данных (SQL) #Описание: Использование распределенных реляционных баз данных (например, PostgreSQL с репликацией или специализированные распределенные SQL-решения).\nПреимущества:\nСтрогая схема данных и поддержка транзакций, что облегчает обеспечение консистентности. Мощные возможности запросов. Недостатки и Причины Отклонения:\nИзбыточность для данной задачи: Для хранения преимущественно конфигурационных данных и состояний (Key-Value характера), сложность реляционной модели и SQL-запросов является избыточной. Сложность развертывания и управления: Развертывание и поддержка высокодоступного распределенного кластера SQL-базы данных значительно сложнее, чем для Key-Value хранилищ, и требует больших ресурсов. Масштабируемость: Хотя современные SQL-базы могут масштабироваться, их горизонтальное масштабирование для Key-Value операций менее эффективно, чем у специализированных KV-хранилищ. 3. Облачные Базы Данных как Сервис #Описание: Использование управляемых облачных сервисов баз данных (например, DynamoDB, Google Cloud Datastore).\nПреимущества:\nВысокая доступность и масштабируемость «из коробки». Отсутствие необходимости в самостоятельном управлении инфраструктурой. Недостатки и Причины Отклонения:\nЗависимость от провайдера: Создает зависимость от конкретного облачного провайдера, что может быть нежелательно для проекта, нацеленного на децентрализацию и устойчивость к внешнему контролю. Потенциальные риски компрометации: Несмотря на высокую степень защиты, внешнее хранение критически важных конфигурационных данных и данных пользователей в стороннем сервисе может представлять неприемлемые риски с точки зрения безопасности и конфиденциальности для проекта, ориентированного на обход блокировок. Стоимость: В долгосрочной перспективе затраты на облачные сервисы могут быть выше, чем на собственную инфраструктуру. Рассмотрение этих альтернатив привело к выводу, что ни один из подходов в чистом виде не отвечает всем требованиям проекта Sigil Gate, особенно в части обеспечения консистентности, отказоустойчивости и сохранности данных при необходимости полного перестроения сети. Это привело к выбору гибридной архитектуры, описанной в следующем разделе.\n","date":"1 января 1 г.","permalink":"https://sigilgate.github.io/docs/data_storage/01_alternative_solutions/","section":"Документация","summary":"\u003ch1 id=\"01-рассмотренные-альтернативные-решения\" class=\"relative group\"\u003e01 Рассмотренные Альтернативные Решения \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#01-%d1%80%d0%b0%d1%81%d1%81%d0%bc%d0%be%d1%82%d1%80%d0%b5%d0%bd%d0%bd%d1%8b%d0%b5-%d0%b0%d0%bb%d1%8c%d1%82%d0%b5%d1%80%d0%bd%d0%b0%d1%82%d0%b8%d0%b2%d0%bd%d1%8b%d0%b5-%d1%80%d0%b5%d1%88%d0%b5%d0%bd%d0%b8%d1%8f\" aria-label=\"Якорь\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h1\u003e\u003cp\u003eПри поиске оптимальной архитектуры для хранения данных сети Sigil Gate были рассмотрены различные подходы. Основными критериями оценки были отказоустойчивость, распределенность, консистентность, удобство автоматизации и возможность полного восстановления данных при катастрофических сбоях.\u003c/p\u003e\n\u003ch2 id=\"1-файловая-система-на-каждом-узле\" class=\"relative group\"\u003e1. Файловая Система на Каждом Узле \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#1-%d1%84%d0%b0%d0%b9%d0%bb%d0%be%d0%b2%d0%b0%d1%8f-%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d0%b0-%d0%bd%d0%b0-%d0%ba%d0%b0%d0%b6%d0%b4%d0%be%d0%bc-%d1%83%d0%b7%d0%bb%d0%b5\" aria-label=\"Якорь\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h2\u003e\u003cp\u003e\u003cstrong\u003eОписание:\u003c/strong\u003e Хранение конфигураций и оперативных данных в файлах (например, JSON, YAML) непосредственно на каждом узле сети.\u003c/p\u003e","title":"Рассмотренные Альтернативные Решения"},{"content":"03.2 Репозиторий Git как Источник Истины #Приватный Git-репозиторий играет критически важную роль в архитектуре хранения данных Sigil Gate, выступая в качестве единственного источника истины (Source of Truth) и надежного механизма для бэкапа и восстановления сети. Он хранит желаемое состояние всей инфраструктуры и её конфигурации.\n1. Роль Источника Истины #Git-репозиторий содержит полную, версионированную и аудируемую историю всех конфигураций сети. Это позволяет:\nПолное восстановление: При полной потере или компрометации всей оперативной инфраструктуры (включая KV-кластер), сеть может быть полностью перестроена с нуля, используя данные из Git-репозитория. Версионирование: Каждое изменение в конфигурации сети фиксируется как коммит, что позволяет отслеживать эволюцию системы и при необходимости откатываться к предыдущим стабильным состояниям. Аудит: История коммитов предоставляет полную картину того, кто, когда и какие изменения вносил в конфигурацию сети, что важно для безопасности и отладки. Декларативное управление: Git-репозиторий описывает, какой должна быть сеть, а не как она должна меняться. Оперативные системы (Root- и Core-ноды) затем стремятся привести реальное состояние сети в соответствие с этим желаемым состоянием. 2. Структура Хранения Данных #В Git-репозитории будут храниться структурированные файлы (например, в формате JSON или YAML), описывающие все сущности и их конфигурации. Примеры категорий данных:\nОписания узлов: Детальные конфигурации для Root-, Core- и Entry-нод (без реальных секретов, которые будут генерироваться и управляться через PKI). Топология: Статические описания связей между Core-нодами и правила привязки Entry-нод. Пользователи: Список зарегистрированных пользователей и их права доступа (без хранения чистых учетных данных). PKI: Метаданные о сертификатах, статусы отзыва (CRL). Важно: Git-репозиторий никогда не должен содержать чувствительные данные, такие как приватные ключи, токены или чистые пароли. Управление секретами осуществляется с помощью инфраструктуры открытых ключей (PKI) и динамических механизмов, управляемых через KV-хранилище.\n3. Взаимодействие с Git-репозиторием # Root-нода: При развертывании сети или реагировании на крупный инцидент, Root-нода использует Git-репозиторий для получения начальной конфигурации. Она также может быть настроена для синхронизации изменений из Git в KV-хранилище. Core-ноды: Для обеспечения непрерывной синхронизации оперативных изменений, все Core-ноды будут иметь доступ к записи в приватный Git-репозиторий. Они будут периодически (или по событию) фиксировать изменения, произошедшие в KV-кластере (например, ротация путей, изменения в статусах Entry-нод), обеспечивая их долгосрочное сохранение и версионирование. Этот механизм гарантирует, что даже при неактивной Root-ноде оперативные изменения не будут потеряны при следующем полном развертывании или синхронизации. Таким образом, Git-репозиторий является центральным звеном для обеспечения надежности и восстанавливаемости всей сети, дополняя оперативность и консистентность KV-хранилища.\n","date":"1 января 1 г.","permalink":"https://sigilgate.github.io/docs/data_storage/03_components/git_repository/","section":"Документация","summary":"\u003ch1 id=\"032-репозиторий-git-как-источник-истины\" class=\"relative group\"\u003e03.2 Репозиторий Git как Источник Истины \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#032-%d1%80%d0%b5%d0%bf%d0%be%d0%b7%d0%b8%d1%82%d0%be%d1%80%d0%b8%d0%b9-git-%d0%ba%d0%b0%d0%ba-%d0%b8%d1%81%d1%82%d0%be%d1%87%d0%bd%d0%b8%d0%ba-%d0%b8%d1%81%d1%82%d0%b8%d0%bd%d1%8b\" aria-label=\"Якорь\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h1\u003e\u003cp\u003eПриватный Git-репозиторий играет критически важную роль в архитектуре хранения данных Sigil Gate, выступая в качестве \u003cstrong\u003eединственного источника истины (Source of Truth)\u003c/strong\u003e и надежного механизма для бэкапа и восстановления сети. Он хранит \u003cem\u003eжелаемое состояние\u003c/em\u003e всей инфраструктуры и её конфигурации.\u003c/p\u003e\n\u003ch2 id=\"1-роль-источника-истины\" class=\"relative group\"\u003e1. Роль Источника Истины \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#1-%d1%80%d0%be%d0%bb%d1%8c-%d0%b8%d1%81%d1%82%d0%be%d1%87%d0%bd%d0%b8%d0%ba%d0%b0-%d0%b8%d1%81%d1%82%d0%b8%d0%bd%d1%8b\" aria-label=\"Якорь\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h2\u003e\u003cp\u003eGit-репозиторий содержит полную, версионированную и аудируемую историю всех конфигураций сети. Это позволяет:\u003c/p\u003e","title":"Репозиторий Git как Источник Истины"},{"content":"04 Синхронизация Данных и Обеспечение Консистентности #Эффективная синхронизация и обеспечение консистентности данных между оперативным Key-Value (KV) хранилищем и долгосрочным Git-репозиторием являются критически важными для поддержания работоспособности, управляемости и восстанавливаемости сети Sigil Gate.\n1. Механизмы Синхронизации #Синхронизация данных будет осуществляться в двух направлениях:\nGit -\u0026gt; KV (Применение желаемого состояния): Этот поток инициируется Root-нодой при развертывании или восстановлении сети, а также может быть запущен для применения глобальных изменений, зафиксированных в Git.\nRoot-нода (или специализированный сервис, развернутый Root-нодой) считывает актуальную конфигурацию из Git-репозитория. На основе этой конфигурации Root-нода обновляет соответствующие записи в KV-кластере. Это гарантирует, что оперативное состояние в KV соответствует желаемому состоянию, зафиксированному в Git. KV -\u0026gt; Git (Сохранение оперативных изменений): Этот поток обеспечивает сохранение всех оперативных изменений, произошедших в KV-хранилище, в Git-репозитории. Это ключевой механизм для обеспечения долгосрочной сохранности динамических данных, учитывая, что Root-нода может быть неактивной.\nРоль Core-нод: Все активные Core-ноды будут иметь права на запись в приватный Git-репозиторий. Каждая Core-нода будет периодически (например, раз в единицу времени, настраиваемый интервал) проверять изменения в той части KV-хранилища, за которую она отвечает (например, статусы своих Entry-нод, ротированные gRPC-пути). При обнаружении изменений Core-нода формирует коммит с описанием этих изменений и отправляет его в Git-репозиторий. Это может быть реализовано с помощью скриптов, которые работают в фоне на каждой Core-ноде. Разрешение конфликтов: Поскольку несколько Core-нод могут одновременно пытаться записать изменения в Git, необходимо реализовать стратегию разрешения конфликтов (например, с использованием git pull --rebase перед коммитом и пушем, или более сложной логики с блокировками на уровне KV, если это применимо к конкретным операциям). Для данных, управляемых отдельными Core-нодами, конфликты будут минимальны, так как они работают в своих областях ответственности. 2. Обеспечение Консистентности Данных #Консистентность данных обеспечивается на нескольких уровнях:\nСтрогая консистентность KV-хранилища: etcd (и Consul) используют протоколы консенсуса (Raft), которые гарантируют строгую консистентность. Это означает, что после успешной записи в KV-хранилище данные будут видны всем клиентам и не будут потеряны при частичных отказах кластера. Git как источник истины: Поскольку Git является окончательным источником истины, при любых расхождениях между KV-хранилищем и Git, состояние Git считается правильным. Это позволяет восстанавливать работоспособное состояние сети в случае непредвиденных проблем в KV-хранилище. Асинхронная синхронизация KV -\u0026gt; Git: Синхронизация оперативных изменений из KV в Git является асинхронной и периодической. Это означает, что в короткие промежутки времени между записями в KV и фиксацией в Git, Git-репозиторий может немного отставать от текущего оперативного состояния. Однако это допустимо для конфигурационных данных, которые не требуют мгновенной глобальной согласованности, и компенсируется надежностью Git как долгосрочного хранилища. Автоматизированный мониторинг и алертинг: Будут внедрены системы мониторинга для отслеживания состояния синхронизации и обнаружения возможных расхождений между KV-хранилищем и Git-репозиторием. В случае обнаружения проблем будут генерироваться алерты для оперативного вмешательства. Этот двунаправленный механизм синхронизации и многоуровневое обеспечение консистентности гарантируют, что сеть Sigil Gate будет всегда работать с актуальными данными, а её состояние будет надежно сохранено для долгосрочной перспективы и возможности восстановления.\n","date":"1 января 1 г.","permalink":"https://sigilgate.github.io/docs/data_storage/04_synchronization_and_consistency/","section":"Документация","summary":"\u003ch1 id=\"04-синхронизация-данных-и-обеспечение-консистентности\" class=\"relative group\"\u003e04 Синхронизация Данных и Обеспечение Консистентности \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#04-%d1%81%d0%b8%d0%bd%d1%85%d1%80%d0%be%d0%bd%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f-%d0%b4%d0%b0%d0%bd%d0%bd%d1%8b%d1%85-%d0%b8-%d0%be%d0%b1%d0%b5%d1%81%d0%bf%d0%b5%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d0%ba%d0%be%d0%bd%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bd%d1%82%d0%bd%d0%be%d1%81%d1%82%d0%b8\" aria-label=\"Якорь\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h1\u003e\u003cp\u003eЭффективная синхронизация и обеспечение консистентности данных между оперативным Key-Value (KV) хранилищем и долгосрочным Git-репозиторием являются критически важными для поддержания работоспособности, управляемости и восстанавливаемости сети Sigil Gate.\u003c/p\u003e\n\u003ch2 id=\"1-механизмы-синхронизации\" class=\"relative group\"\u003e1. Механизмы Синхронизации \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#1-%d0%bc%d0%b5%d1%85%d0%b0%d0%bd%d0%b8%d0%b7%d0%bc%d1%8b-%d1%81%d0%b8%d0%bd%d1%85%d1%80%d0%be%d0%bd%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d0%b8\" aria-label=\"Якорь\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h2\u003e\u003cp\u003eСинхронизация данных будет осуществляться в двух направлениях:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eGit -\u0026gt; KV (Применение желаемого состояния):\u003c/strong\u003e Этот поток инициируется Root-нодой при развертывании или восстановлении сети, а также может быть запущен для применения глобальных изменений, зафиксированных в Git.\u003c/p\u003e","title":"Синхронизация Данных и Обеспечение Консистентности"}]